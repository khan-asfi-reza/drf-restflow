{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"drf-restflow","text":"<p>A declarative library for Django REST Framework. Write type-safe REST APIs with Python annotations, automatic validation, and minimal boilerplate.</p>"},{"location":"#overview","title":"Overview","text":"<p><code>drf-restflow</code> works alongside DRF, not as a replacement. It leverages DRF's powerful serializer infrastructure and extends it with declarative patterns for common tasks.</p> <p>Heavily inspired by FastAPI and django-filter, bringing modern Python features and intuitive API design to Django REST Framework.</p> <p>Current Release: (v1.0.0a1)</p> <p>Available Features:  - Filtering </p>"},{"location":"#table-of-contents","title":"Table of Contents","text":"<ul> <li>Motivation</li> <li>Installation</li> <li>Key Features</li> <li>Quick Example</li> <li>Following</li> <li>Roadmap</li> <li>Contributing</li> </ul>"},{"location":"#motivation","title":"Motivation","text":"<p>Hi, I\u2019m Khan, the author of drf-restflow.</p> <p>This library was born from the realities of building APIs in a fast-moving startup environment.  Most of my work involved large database tables,  constantly evolving product requirements, and the challenge of exposing clean,  reliable REST APIs.  While, also ensuring that new developers could onboard quickly and understand the  codebase and business logic as early as possible.</p> <p>I started with django-filter, which is an excellent and very mature tool. But as our product grew  (and pivoted repeatedly), the FilterSets became harder to maintain. They were getting long, repetitive,  and full of boilerplate.</p> <p>Some might say this was a skill issue, and honestly, I agree.</p> <p>But the truth is, I\u2019m a lazy developer.</p> <p>I like writing less code. I like being fast. I like tools that let me declare what I want instead of wiring everything by hand. Over time,  I built small internal utilities to reduce repetition and make filtering easier. Those tools worked well for my case, , So I decided to compile all those internal utilities into a proper library, so I can use it for other projects as well.</p> <p>Many of the internal toolsets created were built from scratch, which brought some inconsistency, instead of reinventing the wheel, I later decided to use what is already available and battle tested and borrowed ideas from different libraries, for example  FastAPI, django-filter, and django-ninja.  That's how I started drf-restflow, a library that doesn't replace Django Rest Framework but uses its powerful features. One sidenote, there might be other libraries that do exactly what drf-restflow promises to do, or maybe do more than that, I might be unaware,  So, Feel free to contribute or provide any insights, and constructive criticism, thank you.  </p>"},{"location":"#installation","title":"Installation","text":"<pre><code>pip install drf-restflow\n</code></pre> <p>or using uv</p> <pre><code>uv add drf-restflow\n</code></pre>"},{"location":"#requirements","title":"Requirements","text":"<ul> <li>Python 3.10+</li> <li>Django 3.2+</li> <li>Django REST Framework 3.14+</li> <li>PostgreSQL (optional, for PostgreSQL-specific features)</li> </ul>"},{"location":"#key-features","title":"Key Features","text":""},{"location":"#filtering","title":"Filtering","text":"<p>The current release (v1.0.0a1) focuses on declarative filtering with these capabilities:</p>"},{"location":"#declarative-field-definitions","title":"Declarative Field Definitions","text":"<p>Define filters using type annotations, explicit field declarations, or automatic model generation:</p> <pre><code>from restflow.filters import FilterSet\n\nclass ProductFilterSet(FilterSet):\n    name: str                                    # Type annotation\n    price = IntegerField(lookups=[\"comparison\"]) # Explicit field\n\n    class Meta:\n        model = Product                          # Model-based generation\n</code></pre>"},{"location":"#automatic-lookup-generation","title":"Automatic Lookup Generation","text":"<p>Generate multiple filter variants from a single field definition:</p> <pre><code>class ProductFilterSet(FilterSet):\n    price = IntegerField(lookups=[\"comparison\"])\n\n# Automatically generates:\n# - price (exact match)\n# - price__gt, price__gte, price__lt, price__lte (comparisons)\n# - price!, price__gt!, price__gte!, ... (negations)\n</code></pre>"},{"location":"#type-safe-validation","title":"Type-Safe Validation","text":"<p>Built on DRF's validation system with automatic type conversion and detailed error messages:</p> <pre><code># GET /api/products?price__gte=invalid\n# Returns: {\"price__gte\": [\"A valid integer is required.\"]}\n\n# GET /api/products?price=-10\n# Returns: {\"price\": [\"Ensure this value is greater than or equal to 0.\"]}\n</code></pre>"},{"location":"#universal-negation-support","title":"Universal Negation Support","text":"<p>Exclude values using the <code>!</code> suffix on any filter:</p> <pre><code># Exclude categories\nGET /api/products?category!=electronics&amp;category!=books\n\n# Exclude price range\nGET /api/products?price__gte!=1000  # NOT &gt;= 1000 (i.e., &lt; 1000)\n\n# Exclude keywords\nGET /api/products?name__icontains!=refurbished\n</code></pre>"},{"location":"#custom-filter-methods","title":"Custom Filter Methods","text":"<p>Implement complex filtering logic with custom methods using Q objects:</p> <pre><code>from django.db.models import Q\n\nclass ProductFilterSet(FilterSet):\n    in_stock = BooleanField(method=\"filter_in_stock\")\n    search = StringField(method=\"filter_search\")\n\n    def filter_in_stock(self, filterset, queryset, value):\n        if value:\n            return Q(inventory__gt=0)\n        return Q(inventory=0)\n\n    def filter_search(self, filterset, queryset, value):\n        return Q(name__icontains=value) | Q(description__icontains=value)\n</code></pre>"},{"location":"#postgresql-features","title":"PostgreSQL Features","text":"<p>First-class support for PostgreSQL-specific functionality:</p> <pre><code>from django.contrib.postgres.search import SearchVector, SearchQuery\n\nclass ProductFilterSet(FilterSet):\n    # Array fields\n    tags = ListField(child=StringField(), lookups=[\"pg_array\"])\n    # Generates: tags__contains, tags__overlap, tags__contained_by\n\n    # Full-text search\n    search = StringField(method=\"filter_fulltext\")\n\n    def filter_fulltext(self, filterset, queryset, value):\n        vector = SearchVector('name', 'description')\n        query = SearchQuery(value)\n        return queryset.filter(search_vector=query)\n</code></pre>"},{"location":"#operators-processors","title":"Operators &amp; Processors","text":"<p>Control filter combination logic and queryset transformations:</p> <pre><code>class ProductFilterSet(FilterSet):\n    name: str\n    category: str\n\n    class Meta:\n        operator = \"OR\"  # Combine filters with OR instead of AND\n\n        preprocessors = [      # Run before filtering\n            exclude_deleted,\n            apply_permissions,\n            optimize_queries,\n        ]\n\n        postprocessors = [     # Run after filtering\n            apply_default_ordering,\n            ensure_distinct,\n        ]\n</code></pre>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>from django.db import models\nfrom restflow.filters import FilterSet, StringField, IntegerField\nfrom rest_framework.decorators import api_view\nfrom rest_framework.response import Response\n\n# Model\nclass Product(models.Model):\n    name = models.CharField(max_length=100)\n    price = models.IntegerField()\n    category = models.CharField(max_length=50)\n    in_stock = models.BooleanField(default=True)\n\n# FilterSet\nclass ProductFilterSet(FilterSet):\n    name = StringField(lookups=[\"icontains\"])\n    price = IntegerField(lookups=[\"comparison\"])\n    category: str\n\n    class Meta:\n        model = Product\n        order_fields = [(\"price\", \"price\"), (\"name\", \"name\")]\n\n# View\n@api_view(['GET'])\ndef product_list(request):\n    queryset = Product.objects.all()\n    filterset = ProductFilterSet(request=request)\n    filtered_qs = filterset.filter_queryset(queryset)\n    return Response({\n        'count': filtered_qs.count(),\n        'results': list(filtered_qs.values())\n    })\n</code></pre> <p>API Usage: <pre><code># Filter by name containing \"laptop\"\nGET /api/products?name__icontains=laptop\n\n# Filter by price range\nGET /api/products?price__gte=100&amp;price__lte=500\n\n# Exclude categories\nGET /api/products?category!=electronics\n\n# Order by price descending\nGET /api/products?order_by=-price\n\n# Combine filters\nGET /api/products?name__icontains=laptop&amp;price__lte=1000&amp;category!=refurbished&amp;order_by=price\n</code></pre></p>"},{"location":"#following","title":"Following","text":"<ul> <li>Installation - Install drf-restflow</li> <li>Quick Start Guide - Build your first FilterSet</li> <li>Basic Concepts - Understand core concepts</li> <li>Filtering Tutorial - Complete filtering guide</li> <li>FilterSet Guide - Comprehensive FilterSet documentation</li> <li>Fields Guide - All field types and options</li> </ul>"},{"location":"#roadmap","title":"Roadmap","text":""},{"location":"#current-release-v100a1","title":"Current Release: v1.0.0a1","text":"<p>Filtering - Declarative query parameter filtering with type annotations</p>"},{"location":"#future","title":"Future","text":"<ul> <li>Serializer enhancements: Declarative serializers with type annotations</li> <li>API / View: FastAPI style api / view declaration</li> <li>Async Support: Async filters and views</li> </ul> <p>Alpha Notice: This is version 1.0.0a1 - the first alpha release. The filtering API is mostly stable, but breaking changes may occur as we add features and gather community feedback.</p>"},{"location":"#contributing","title":"Contributing","text":"<p>Contributions are welcome! Check out the Contributing Guide for guidelines.</p>"},{"location":"#license","title":"License","text":"<p>BSD 3-Clause License</p>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to drf-restflow will be documented in this file.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p>"},{"location":"changelog/#100a1-2025-11-25","title":"[1.0.0a1] - 2025-11-25","text":""},{"location":"changelog/#added","title":"Added","text":""},{"location":"changelog/#core-features","title":"Core Features","text":"<ul> <li>FilterSet: Declarative filtering system for Django REST Framework</li> <li>Field Types: Comprehensive set of filter fields</li> <li>StringField, IntegerField, FloatField, DecimalField</li> <li>BooleanField, DateField, DateTimeField, TimeField, DurationField</li> <li>ChoiceField, MultipleChoiceField</li> <li>EmailField, IPAddressField</li> <li>ListField for array filtering</li> <li>OrderField for result ordering</li> <li>RelatedField for related fields in models</li> <li>Field base class for custom filters</li> </ul>"},{"location":"changelog/#declaration-styles","title":"Declaration Styles","text":"<ul> <li>Type annotation support (<code>name: str</code>, <code>price: int</code>)</li> <li>Explicit field declarations</li> <li>Model-based automatic field generation</li> <li>Mixed declaration styles</li> </ul>"},{"location":"changelog/#lookup-system","title":"Lookup System","text":"<ul> <li>Automatic lookup generation from field definitions</li> <li>Lookup categories (basic, text, comparison, date, time, postgres, pg_array)</li> <li>Custom lookup expressions via strings or callables</li> <li>Field variants (base field + lookups + negations)</li> </ul>"},{"location":"changelog/#filtering-features","title":"Filtering Features","text":"<ul> <li>Negation support via <code>!</code> suffix</li> <li>Multiple filter operators (AND, OR, XOR)</li> <li>Custom filter methods</li> <li>Preprocessors and postprocessors</li> <li>Related field filtering</li> </ul>"},{"location":"changelog/#ordering","title":"Ordering","text":"<ul> <li>OrderField for flexible result ordering</li> <li>Ascending/descending support</li> <li>Multiple field ordering</li> <li>Configurable ordering direction</li> </ul>"},{"location":"changelog/#postgresql-support","title":"PostgreSQL Support","text":"<ul> <li>PostgreSQL array field filtering</li> <li>Array lookups (contains, overlaps, contained_by)</li> <li>Full-text search support</li> <li>Trigram similarity</li> </ul>"},{"location":"changelog/#model-integration","title":"Model Integration","text":"<ul> <li>Automatic field generation from Django models</li> <li>Support for model field types</li> <li>ForeignKey and OneToOneField filtering</li> <li>Model choice field detection</li> </ul>"},{"location":"changelog/#validation","title":"Validation","text":"<ul> <li>Built on DRF's validation system</li> <li>Automatic type conversion</li> <li>Field-level and custom validators</li> <li>Detailed error messages</li> </ul>"},{"location":"changelog/#type-safety","title":"Type Safety","text":"<ul> <li>Python type hint support</li> <li>Automatic field type inference</li> <li>Type mapping for common Python types</li> <li>Literal type for choices</li> </ul>"},{"location":"changelog/#documentation","title":"Documentation","text":"<ul> <li>Comprehensive user guide</li> <li>API reference</li> <li>Quick start tutorial</li> <li>PostgreSQL guide</li> <li>Migration guide from django-filter</li> </ul>"},{"location":"changelog/#testing","title":"Testing","text":"<ul> <li>Test suite with 95%+ coverage</li> <li>PostgreSQL-specific tests</li> <li>Multiple Python version support (3.10-3.14)</li> <li>Multiple Django version support (3.2-5.2)</li> <li>CI/CD with GitHub Actions</li> </ul>"},{"location":"changelog/#developer-experience","title":"Developer Experience","text":"<ul> <li>Modern Python features (type hints, dataclasses)</li> <li>Clear error messages</li> <li>Extensive docstrings</li> <li>IDE-friendly API</li> </ul>"},{"location":"changelog/#version-support","title":"Version Support","text":"Version Python Django DRF Status 1.0.0a1 3.10-3.14 3.2-5.2 3.14+ Alpha"},{"location":"changelog/#migration-from-django-filter","title":"Migration from django-filter","text":"<p>drf-restflow offers similar functionality to django-filter with a more modern, declarative API. Key differences:</p> <ul> <li>Type annotations: Use Python type hints instead of explicit field declarations</li> <li>Automatic negation: Built-in <code>!</code> suffix support for all filters</li> <li>Lookup categories: Group related lookups (e.g., \"comparison\" for gt/gte/lt/lte)</li> <li>Better validation: Integrated with DRF's validation system</li> </ul> <p>For migration assistance, refer to the FilterSet Guide and Fields Guide for comprehensive documentation.</p>"},{"location":"changelog/#deprecation-policy","title":"Deprecation Policy","text":"<p>Following semantic versioning:</p> <ul> <li>Major versions (x.0.0): May include breaking changes</li> <li>Minor versions (0.x.0): New features, backward compatible</li> <li>Patch versions (0.0.x): Bug fixes, backward compatible</li> </ul> <p>Deprecation warnings will be issued for at least one minor version before removal.</p>"},{"location":"changelog/#reporting-issues","title":"Reporting Issues","text":"<p>Found a bug or have a feature request? Please open an issue on GitHub.</p>"},{"location":"changelog/#contributing","title":"Contributing","text":"<p>See Contributing Guide for information on how to contribute to this changelog and the project.</p>"},{"location":"contributing/","title":"Contributing to drf-restflow","text":"<p>Thanks for considering contributing to <code>drf-restflow</code>. This project is building a modern, declarative framework on top of Django REST Framework, heavily inspired by FastAPI, and contributions are welcome.</p>"},{"location":"contributing/#the-vision","title":"The Vision","text":"<p><code>drf-restflow</code> works on top of DRF, not as a replacement. The project leverages DRF's serializer infrastructure  and extends it with declarative patterns such as type annotations, less boilerplate,  automatic validation.  Right now the project has launched the filters module  in v1.0.0a1, which leverages DRF serializers for filtering.  Planned additions include annotated serializers,  caching utilities, and more cool stuff.</p>"},{"location":"contributing/#getting-started","title":"Getting Started","text":""},{"location":"contributing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.10 or higher</li> <li>Git</li> <li>Familiarity with Django and Django REST Framework</li> </ul>"},{"location":"contributing/#setting-up-development-environment","title":"Setting Up Development Environment","text":"<ol> <li>Fork and Clone</li> </ol> <p>Fork the repo from github, Restflow</p> <ol> <li>Install Development Dependencies</li> </ol> <p>Using uv [Recommended]</p> <pre><code>uv sync --all-groups\n</code></pre> <p>Or using pip and virtual env</p> <pre><code>pip install -r requirements/requirements-dev.txt\n``````\n\n## Development Workflow\n\n### 1. Create a Branch\n\n```bash\ngit checkout -b feature/your-feature-name\n# or\ngit checkout -b fix/your-bug-fix\n</code></pre>"},{"location":"contributing/#2-make-changes","title":"2. Make Changes","text":"<p>Follow the project's coding standards and write tests for new features.</p>"},{"location":"contributing/#3-run-tests","title":"3. Run Tests","text":"<pre><code># Run all tests\npytest\n\n# Run specific test file\npytest tests/filters/test_fields.py\n\n# Run with coverage\npytest --cov=restflow --cov-report=html\n\n# Run tox for all Python versions\ntox\n</code></pre>"},{"location":"contributing/#4-lint-your-code","title":"4. Lint Your Code","text":"<pre><code>ruff check restflow\n</code></pre> <p>To fix</p> <pre><code>ruff check resflow --fix\n</code></pre>"},{"location":"contributing/#5-commit-changes","title":"5. Commit Changes","text":"<pre><code>git add .\ngit commit -m \"feat: add new feature\"\n</code></pre> <p>Follow conventional commit messages: - <code>feat:</code> New feature - <code>fix:</code> Bug fix - <code>docs:</code> Documentation changes - <code>test:</code> Test changes - <code>refactor:</code> Code refactoring - <code>chore:</code> Maintenance tasks</p>"},{"location":"contributing/#6-push-and-create-pull-request","title":"6. Push and Create Pull Request","text":"<pre><code>git push origin feature/your-feature-name\n</code></pre> <p>Then create a pull request on GitHub.</p>"},{"location":"contributing/#code-standards","title":"Code Standards","text":""},{"location":"contributing/#python-style","title":"Python Style","text":"<ul> <li>Follow PEP 8</li> <li>Use type hints</li> <li>Maximum line length: 80 characters</li> <li>Use ruff for linting and formatting</li> </ul>"},{"location":"contributing/#docstrings","title":"Docstrings","text":"<p>Use Google-style docstrings:</p> <pre><code>def function_name(param1: str, param2: int) -&gt; bool:\n    \"\"\"\n    Short description of the function.\n\n    Longer description if needed, explaining the function's behavior,\n    edge cases, and usage examples.\n\n    Args:\n        param1: Description of param1.\n        param2: Description of param2.\n\n    Returns:\n        Description of return value.\n\n    Raises:\n        ValueError: Description of when this error is raised.\n\n    Examples:\n        &gt;&gt;&gt; function_name(\"test\", 42)\n        True\n    \"\"\"\n    pass\n</code></pre>"},{"location":"contributing/#tests","title":"Tests","text":"<ul> <li>Write tests for all new features</li> <li>Maintain or improve code coverage</li> <li>Use descriptive test names</li> <li>Follow AAA pattern (Arrange, Act, Assert)</li> </ul> <pre><code>def test_field_generates_lookup_variants():\n    \"\"\"Test that field generates correct lookup variants.\"\"\"\n    # Arrange\n    field = IntegerField(lookups=[\"gte\", \"lte\"])\n\n    # Act\n    variants = field.get_lookup_variants()\n\n    # Assert\n    assert \"gte\" in variants\n    assert \"lte\" in variants\n</code></pre>"},{"location":"contributing/#project-structure","title":"Project Structure","text":"<pre><code>drf-restflow/\n\u251c\u2500\u2500 restflow/\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 filters/  # Individual features\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u251c\u2500\u2500 fields.py      # Field definitions\n\u2502       \u2514\u2500\u2500 filters.py     # FilterSet and metaclass\n\u251c\u2500\u2500 tests/\n\u2502   \u251c\u2500\u2500 conftest.py\n\u2502   \u251c\u2500\u2500 models.py\n\u2502   \u2514\u2500\u2500 filters/\n\u2502       \u251c\u2500\u2500 test_fields.py\n\u2502       \u251c\u2500\u2500 test_filters.py\n\u2502       \u2514\u2500\u2500 test_postgres.py\n\u251c\u2500\u2500 docs/                  # Documentation\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 tox.ini\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"contributing/#running-tests","title":"Running Tests","text":""},{"location":"contributing/#all-tests","title":"All Tests","text":"<pre><code>python runtests.py\n</code></pre>"},{"location":"contributing/#specific-test-module","title":"Specific Test Module","text":"<pre><code>python runtests.py tests/filters/test_fields.py\n</code></pre>"},{"location":"contributing/#with-coverage","title":"With Coverage","text":"<pre><code>python runtests.py --cov=restflow --cov-report=html\nopen htmlcov/index.html\n</code></pre>"},{"location":"contributing/#postgresql-tests","title":"PostgreSQL Tests","text":"<pre><code># Set up PostgreSQL database\nexport POSTGRES_DB_URL=\"postgresql://user:password@localhost:5432/test_db\"\n\n# Run PostgreSQL tests\npytest -m postgres\n</code></pre>"},{"location":"contributing/#tox-multiple-python-versions","title":"Tox (Multiple Python Versions)","text":"<pre><code># Run all environments\ntox\n\n# Run specific environment\ntox -e py312\n\n# Run PostgreSQL tests\ntox -e py312-postgres\n</code></pre>"},{"location":"contributing/#documentation","title":"Documentation","text":""},{"location":"contributing/#building-documentation","title":"Building Documentation","text":"<pre><code># Install docs dependencies\npip install mkdocs mkdocs-material\n\n# Serve locally\nmkdocs serve\n\n# Build\nmkdocs build\n</code></pre>"},{"location":"contributing/#writing-documentation","title":"Writing Documentation","text":"<ul> <li>Use clear, concise language</li> <li>Include code examples</li> <li>Add usage patterns and common pitfalls</li> <li>Update API reference when adding new features</li> </ul>"},{"location":"contributing/#pull-request-process","title":"Pull Request Process","text":"<ol> <li>Ensure tests pass: All tests must pass</li> <li>Update documentation: Document new features</li> <li>Add changelog entry: Update CHANGELOG.md</li> <li>Code review: Address review feedback</li> <li>Squash commits: Clean up commit history if needed</li> </ol>"},{"location":"contributing/#pr-checklist","title":"PR Checklist","text":"<ul> <li>[ ] Tests added/updated</li> <li>[ ] Documentation updated</li> <li>[ ] Changelog updated</li> <li>[ ] Code passes linting</li> <li>[ ] All tests pass</li> <li>[ ] Commit messages follow conventions</li> </ul>"},{"location":"contributing/#reporting-issues","title":"Reporting Issues","text":"<p>When reporting bugs, include:</p> <ol> <li>Description: Clear description of the issue</li> <li>Steps to reproduce: Minimal code to reproduce</li> <li>Expected behavior: What should happen</li> <li>Actual behavior: What actually happens</li> <li>Environment:</li> <li>Python version</li> <li>Django version</li> <li>DRF version</li> <li>drf-restflow version</li> </ol> <p>Example:</p> <pre><code>**Bug Description**\nFilterSet raises TypeError when using List[int] annotation.\n\n**To Reproduce**\n```python\nclass MyFilterSet(FilterSet):\n    ids: List[int]\n</code></pre> <p>Expected: Should create ListField with IntegerField child Actual: Raises TypeError</p> <p>Environment - Python 3.12 - Django 5.0 - DRF 3.14 - drf-restflow 1.0.0a1</p>"},{"location":"contributing/#feature-requests","title":"Feature Requests","text":"<p>When proposing features, include:</p> <ol> <li>Use case: Why is this needed?</li> <li>Proposed API: How should it work?</li> <li>Alternatives: Other approaches considered</li> <li>Implementation: Ideas for implementation</li> </ol>"},{"location":"contributing/#versioning","title":"Versioning","text":"<p>Following semantic versioning:</p> <ul> <li>Major versions (x.0.0): May include breaking changes</li> <li>Minor versions (0.x.0): New features, backward compatible</li> <li>Patch versions (0.0.x): Bug fixes, backward compatible</li> <li>Pre-Release versions (0.0.0(a|b|rc)x): Pre-release candidates, eg: 1.0.0a1 -&gt; alpha release, 1.0.0b1 -&gt; beta release</li> </ul>"},{"location":"getting-started/concepts/","title":"Basic Concepts","text":"<p>This guide covers the core concepts and design philosophy of <code>drf-restflow</code>.</p>"},{"location":"getting-started/concepts/#what-is-drf-restflow","title":"What is drf-restflow?","text":"<p><code>drf-restflow</code> is a declarative library for Django REST Framework that brings modern Python features and FastAPI-like ergonomics to Django. The library is being built in phases, with each release adding new declarative capabilities.</p> <p>Current Features: - Filtering - Declarative query parameter filtering with type annotations</p>"},{"location":"getting-started/concepts/#core-philosophy","title":"Core Philosophy","text":"<p>drf-restflow follows these principles:</p> <ol> <li>Declarative over Imperative: Define what you want, not how to do it</li> <li>Type Safety: Leverage Python type annotations for validation and IDE support</li> <li>Less Boilerplate: Reduce repetitive code while maintaining flexibility</li> <li>DRF Integration: Work alongside DRF, not replace it</li> <li>Modern Python: Take advantage of Python 3.10+ features</li> </ol>"},{"location":"getting-started/concepts/#filtering","title":"Filtering","text":""},{"location":"getting-started/concepts/#filterset","title":"FilterSet","text":"<p>A <code>FilterSet</code> is the main abstraction in drf-restflow. It's a declarative class that:</p> <ol> <li>Defines filterable fields</li> <li>Validates query parameters</li> <li>Applies filters to Django querysets</li> </ol> <pre><code>from restflow.filters import FilterSet\n\nclass ProductFilterSet(FilterSet):\n    name: str\n    price: int\n\n    class Meta:\n        model = Product\n</code></pre>"},{"location":"getting-started/concepts/#how-it-works","title":"How It Works","text":"<p>When you use a FilterSet:</p> <ol> <li>Initialization: FilterSet receives query parameters from the request</li> <li>Validation: Parameters are validated using DRF field validators</li> <li>Filtering: Validated data is converted into Django ORM filters</li> <li>Execution: Filters are applied to the queryset</li> </ol> <pre><code># Step 1: Initialize\nfilterset = ProductFilterSet(request=request)\n\n# Step 2 &amp; 3: Validate and get filtered queryset\nfiltered_qs = filterset.filter_queryset(Product.objects.all())\n</code></pre>"},{"location":"getting-started/concepts/#fields","title":"Fields","text":"<p>Fields define what can be filtered and how. Each field corresponds to a query parameter.</p>"},{"location":"getting-started/concepts/#field-declaration-styles","title":"Field Declaration Styles","text":"<p>drf-restflow supports multiple ways to declare fields:</p>"},{"location":"getting-started/concepts/#1-type-annotations","title":"1. Type Annotations","text":"<pre><code>class ProductFilterSet(FilterSet):\n    name: str\n    price: int\n    in_stock: bool\n</code></pre>"},{"location":"getting-started/concepts/#2-explicit-field-objects","title":"2. Explicit Field Objects","text":"<pre><code>from restflow.filters import StringField, IntegerField\n\nclass ProductFilterSet(FilterSet):\n    name = StringField()\n    price = IntegerField()\n</code></pre>"},{"location":"getting-started/concepts/#3-model-based-generation","title":"3. Model-Based Generation","text":"<pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        model = Product\n        fields = \"__all__\"  # or ['name', 'price', 'category']\n</code></pre>"},{"location":"getting-started/concepts/#4-mixed-style","title":"4. Mixed Style","text":"<pre><code>from restflow.filters import Field\n\nclass ProductFilterSet(FilterSet):\n    name: str = Field(lookups=[\"icontains\"])\n    price: int = Field(lookups=[\"comparison\"])\n    category = StringField()\n</code></pre>"},{"location":"getting-started/concepts/#field-priority","title":"Field Priority","text":"<p>When the same field is declared in multiple ways, this priority applies:</p> <p>Explicit declarations &gt; Type annotations &gt; Model fields</p> <pre><code>class ProductFilterSet(FilterSet):\n    # This takes precedence\n    name = StringField(lookups=[\"icontains\"])\n\n    # This would be ignored\n    name: str\n\n    class Meta:\n        model = Product\n        fields = ['name']  # This is ignored since name is explicitly declared\n        extra_kwargs = {\n            \"name\": {\n                \"allow_negate\": False # This is also ignored since name is explicitly declared\n            }\n        }\n</code></pre>"},{"location":"getting-started/concepts/#lookup-expressions","title":"Lookup Expressions","text":"<p>Lookups define how to filter. They correspond to Django ORM lookup expressions.</p>"},{"location":"getting-started/concepts/#basic-lookups","title":"Basic Lookups","text":"<pre><code>price = IntegerField()\n# Query: ?price=100\n# ORM: Product.objects.filter(price=100)\n</code></pre>"},{"location":"getting-started/concepts/#field-lookups","title":"Field Lookups","text":"<pre><code>price = IntegerField(lookups=[\"gte\", \"lte\"])\n# Query: ?price__gte=100\n# ORM: Product.objects.filter(price__gte=100)\n</code></pre>"},{"location":"getting-started/concepts/#lookup-categories","title":"Lookup Categories","text":"<p>Instead of listing individual lookups, use categories:</p> <pre><code>price = IntegerField(lookups=[\"comparison\"])\n# Expands to: [\"gt\", \"gte\", \"lt\", \"lte\"]\n\nname = StringField(lookups=[\"text\"])\n# Expands to: [\"icontains\", \"contains\", \"startswith\", \"endswith\", \"iexact\"]\n</code></pre> <p>Available Categories:</p> <ul> <li><code>basic</code>: <code>[\"exact\", \"in\", \"isnull\"]</code></li> <li><code>text</code>: <code>[\"icontains\", \"contains\", \"startswith\", \"endswith\", \"iexact\"]</code></li> <li><code>comparison</code>: <code>[\"gt\", \"gte\", \"lt\", \"lte\"]</code></li> <li><code>date</code>: <code>[\"date\", \"year\", \"month\", \"day\", \"week\", \"week_day\", \"quarter\"]</code></li> <li><code>time</code>: <code>[\"time\", \"hour\", \"minute\", \"second\"]</code></li> <li><code>postgres</code>: <code>[\"search\", \"trigram_similar\", \"unaccent\"]</code></li> <li><code>pg_array</code>: <code>[\"contains\", \"overlaps\", \"contained_by\"]</code></li> </ul>"},{"location":"getting-started/concepts/#field-variants","title":"Field Variants","text":"<p>Each field declaration can generate multiple filter fields:</p>"},{"location":"getting-started/concepts/#base-field","title":"Base Field","text":"<pre><code>name = StringField()\n</code></pre> <p>Generates: <code>name</code> filter (exact match)</p>"},{"location":"getting-started/concepts/#with-lookups","title":"With Lookups","text":"<pre><code>price = IntegerField(lookups=[\"gte\", \"lte\"])\n</code></pre> <p>Generates: - <code>price</code> (exact match) - <code>price__gte</code> (greater than or equal) - <code>price__lte</code> (less than or equal)</p>"},{"location":"getting-started/concepts/#with-negation","title":"With Negation","text":"<pre><code>category = StringField(allow_negate=True)  # Default is True\n</code></pre> <p>Generates: - <code>category</code> (include) - <code>category!</code> (exclude)</p>"},{"location":"getting-started/concepts/#complete-example","title":"Complete Example","text":"<pre><code>price = IntegerField(lookups=[\"gte\", \"lte\"])\n</code></pre> <p>Generates all these fields: - <code>price</code> - <code>price__gte</code> - <code>price__lte</code> - <code>price!</code> - <code>price__gte!</code> - <code>price__lte!</code></p>"},{"location":"getting-started/concepts/#negation","title":"Negation","text":"<p>Negation allows excluding values using the <code>!</code> suffix:</p> <pre><code># Include only electronics\n?category=electronics\n\n# Exclude electronics\n?category!=electronics\n\n# Exclude multiple categories\n?category!=electronics&amp;category!=books\n</code></pre>"},{"location":"getting-started/concepts/#disabling-negation","title":"Disabling Negation","text":"<pre><code># For individual fields\ncategory = StringField(allow_negate=False)\n\n# For all annotated and model-generated fields\nclass ProductFilterSet(FilterSet):\n    class Meta:\n        model = Product\n        fields = \"__all__\"\n        allow_negate = False\n</code></pre>"},{"location":"getting-started/concepts/#ordering","title":"Ordering","text":"<p>FilterSets can generate OrderField for sorting results:</p> <pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        model = Product\n        order_fields = [(\"price\", \"price\"), (\"name\", \"name\")]\n</code></pre> <p>Usage:</p> <pre><code>?order_by=price      # Ascending\n?order_by=-price     # Descending\n?order_by=name,-price  # Multiple fields\n</code></pre>"},{"location":"getting-started/concepts/#validation","title":"Validation","text":"<p>FilterSets use DRF's validation system:</p> <pre><code># Valid request\n?price=100  # \u2713 Validated as integer\n\n# Invalid request\n?price=abc  # \u2717 Returns: {\"price\": [\"A valid integer is required.\"]}\n</code></pre>"},{"location":"getting-started/concepts/#custom-validation","title":"Custom Validation","text":"<p>Add custom validation using DRF field validators:</p> <pre><code>from rest_framework.validators import MinValueValidator\n\nclass ProductFilterSet(FilterSet):\n    price = IntegerField(validators=[MinValueValidator(0)])\n</code></pre>"},{"location":"getting-started/concepts/#inlinefilterset","title":"InlineFilterSet","text":"<p>Create FilterSets dynamically without defining a class:</p> <pre><code>from restflow.filters import InlineFilterSet\n\n# Simple model-based FilterSet\nProductFilterSet = InlineFilterSet(\n    name=\"ProductFilterSet\",\n    model=Product\n)\n\n# With specific fields\nProductFilterSet = InlineFilterSet(\n    model=Product,\n    fields=[\"name\", \"price\", \"category\"]\n)\n\n# With field definitions\nProductFilterSet = InlineFilterSet(\n    fields={\n        \"name\": StringField(lookups=[\"icontains\"]),\n        \"price\": IntegerField(lookups=[\"comparison\"]),\n        \"category\": str\n    }\n)\n\n# With ordering\nProductFilterSet = InlineFilterSet(\n    model=Product,\n    order_fields=[(\"price\", \"price\"), (\"name\", \"name\")]\n)\n\n# Use it like a regular FilterSet\nfilterset = ProductFilterSet(request=request)\n</code></pre> <p>Use cases: - Quick prototyping - Dynamic FilterSet generation - Programmatic FilterSet creation - Testing</p>"},{"location":"getting-started/concepts/#meta-options","title":"Meta Options","text":"<p>The <code>Meta</code> class configures FilterSet behavior:</p> <pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        model = Product                    # Model to filter\n        fields = \"__all__\"                 # Fields to include\n        exclude = ['internal_id']          # Fields to exclude\n        order_fields = [...]               # Enable ordering\n        order_param = \"order_by\"           # Order query parameter name\n        operator = \"AND\"                   # Filter combination logic\n        extra_kwargs = {...}               # Field configuration\n        allow_negate = True                # Enable negation\n        related_fields = [...]             # Enable related field filtering\n</code></pre>"},{"location":"getting-started/concepts/#extra_kwargs","title":"extra_kwargs","text":"<p>Configure field behavior without explicit declarations:</p> <pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        model = Product\n        fields = [\"name\", \"price\", \"category\", \"created_at\"]\n        extra_kwargs = {\n            \"name\": {\n                \"lookups\": [\"icontains\"],\n                \"required\": True\n            },\n            \"price\": {\n                \"lookups\": [\"comparison\"],\n                \"min_value\": 0,\n                \"max_value\": 1000000\n            },\n            \"category\": {\n                \"lookups\": [\"exact\", \"in\"],\n                \"allow_negate\": False\n            },\n            \"created_at\": {\n                \"lookups\": [\"date\"],\n                \"input_formats\": [\"%Y-%m-%d\"]\n            }\n        }\n</code></pre> <p>Common use cases:</p> <pre><code># Add lookups to model fields\nextra_kwargs = {\n    \"name\": {\"lookups\": [\"icontains\", \"startswith\"]},\n    \"price\": {\"lookups\": [\"comparison\"]}\n}\n\n# Add validation\nextra_kwargs = {\n    \"price\": {\n        \"min_value\": 0,\n        \"validators\": [custom_price_validator]\n    }\n}\n\n# Configure field behavior\nextra_kwargs = {\n    \"status\": {\n        \"required\": True,\n        \"allow_negate\": False\n    }\n}\n\n# Override default settings\nextra_kwargs = {\n    \"description\": {\n        \"max_length\": 500,\n        \"trim_whitespace\": True\n    }\n}\n</code></pre>"},{"location":"getting-started/concepts/#operators","title":"Operators","text":"<p>Control how multiple filters are combined:</p> <pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        operator = \"AND\"  # All filters must match (default)\n\n# AND - All conditions must be true\n?name=laptop&amp;price__gte=100&amp;in_stock=true\n# SQL: WHERE name='laptop' AND price&gt;=100 AND in_stock=true\n</code></pre> <p>OR Operator: <pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        operator = \"OR\"  # Any condition can match\n\n# Any condition matches\n?name=laptop&amp;category=electronics\n# SQL: WHERE name='laptop' OR category='electronics'\n</code></pre></p> <p>XOR Operator: <pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        operator = \"XOR\"  # Exactly one condition must match\n\n# Exactly one condition must be true\n?is_featured=true&amp;on_sale=true\n# SQL: WHERE (is_featured=true) XOR (on_sale=true)\n</code></pre></p> <p>Use cases: - <code>AND</code>: Standard filtering (most common) - <code>OR</code>: Search across multiple fields - <code>XOR</code>: Mutually exclusive conditions</p>"},{"location":"getting-started/concepts/#orderfield","title":"OrderField","text":"<p>Enable result ordering via query parameters:</p> <pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        model = Product\n        order_fields = [\n            (\"price\", \"price\"),\n            (\"name\", \"name\"),\n            (\"date\", \"created_at\")\n        ]\n        order_field_labels = [\n            (\"price\", \"Price\"),\n            (\"name\", \"Product Name\"),\n            (\"date\", \"Date Created\")\n        ]\n        order_param = \"order_by\"  # Custom parameter name (default: \"order_by\")\n        default_order_fields = [\"created_at\"]  # Default ordering\n\n# Usage\n?order_by=price        # Ascending by price\n?order_by=-price       # Descending by price\n?order_by=name,-price  # Name asc, then price desc\n</code></pre> <p>Explicit OrderField: <pre><code>from restflow.filters import OrderField\n\nclass ProductFilterSet(FilterSet):\n    sort = OrderField(\n        fields=[(\"price\", \"price\"), (\"name\", \"name\")],\n        labels=[(\"price\", \"Price\"), (\"name\", \"Name\")],\n        override_order_dir=\"asc\"  # or \"desc\"\n    )\n\n# Custom parameter name\n?sort=price\n?sort=-name\n</code></pre></p>"},{"location":"getting-started/concepts/#relatedfield","title":"RelatedField","text":"<p>Filter across relationships:</p> <pre><code>from restflow.filters import RelatedField\n\nclass Product(models.Model):\n    name = models.CharField(max_length=200)\n    category = models.ForeignKey(Category, on_delete=models.CASCADE)\n\nclass Category(models.Model):\n    name = models.CharField(max_length=100)\n    description = models.TextField()\n\n# FilterSet with related fields\nclass ProductFilterSet(FilterSet):\n    category = RelatedField(\n        model=Category,\n        fields=[\"name\", \"description\"]\n    )\n\n# Generates filters:\n# - category__name\n# - category__name__icontains (if lookups configured)\n# - category__description\n# - category__description__icontains\n\n# Usage\n?category__name=Electronics\n?category__name__icontains=elec\n</code></pre> <p>Via Meta: <pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        model = Product\n        fields = [\"name\", \"price\"]\n        related_fields = [\"category\"]  # Auto-expand category fields\n        extra_kwargs = {\n            \"category\": {\n                \"exclude\": [\"internal_id\"],  # Exclude from related fields\n                \"name\": {\"lookups\": [\"icontains\"]}\n            }\n        }\n</code></pre></p>"},{"location":"getting-started/concepts/#request-integration","title":"Request Integration","text":""},{"location":"getting-started/concepts/#from-request-object","title":"From Request Object","text":"<pre><code>filterset = ProductFilterSet(request=request)\n</code></pre> <p>Automatically extracts <code>request.query_params</code> or <code>request.GET</code>.</p>"},{"location":"getting-started/concepts/#from-dictionary","title":"From Dictionary","text":"<pre><code>data = {'name': 'laptop', 'price__gte': 100}\nfilterset = ProductFilterSet(data=data)\n</code></pre>"},{"location":"getting-started/concepts/#queryset-filtering","title":"Queryset Filtering","text":"<p>Apply filters to any Django queryset:</p> <pre><code># Basic usage\nqueryset = Product.objects.all()\nfilterset = ProductFilterSet(request=request)\nfiltered_qs = filterset.filter_queryset(queryset)\n\n# With prefetch/select_related\nqueryset = Product.objects.select_related('category').prefetch_related('tags')\nfilterset = ProductFilterSet(request=request)\nfiltered_qs = filterset.filter_queryset(queryset)  # Preserves optimizations\n\n# With annotations\nqueryset = Product.objects.annotate(total_reviews=Count('reviews'))\nfilterset = ProductFilterSet(request=request)\nfiltered_qs = filterset.filter_queryset(queryset)\n</code></pre>"},{"location":"getting-started/concepts/#type-safety","title":"Type Safety","text":"<p>When using type annotations, drf-restflow maps Python types to appropriate fields:</p> Python Type Field Type Lookup Categories <code>str</code> <code>StringField</code> basic, text <code>int</code> <code>IntegerField</code> basic, comparison <code>float</code> <code>FloatField</code> basic, comparison <code>bool</code> <code>BooleanField</code> basic <code>datetime.date</code> <code>DateField</code> basic, comparison, date <code>datetime.datetime</code> <code>DateTimeField</code> basic, comparison, date, time <code>datetime.time</code> <code>TimeField</code> basic, comparison, time <code>decimal.Decimal</code> <code>DecimalField</code> basic, comparison <code>List[T]</code> <code>ListField</code> basic <code>Literal[...]</code> <code>ChoiceField</code> basic <code>Optional[T]</code> Corresponding field Same as T"},{"location":"getting-started/concepts/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start - Build your first FilterSet</li> <li>Filtering Tutorial - Complete filtering walkthrough</li> <li>FilterSet Guide - Comprehensive FilterSet documentation</li> <li>Fields Guide - All field types and options</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>Install <code>drf-restflow</code>, a declarative library for Django REST Framework that brings modern Python features and FastAPI-like ergonomics to your Django projects.</p>"},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<p>Before installing <code>drf-restflow</code>, ensure you have:</p> <ul> <li>Python 3.10 or higher</li> <li>Django 3.2 or higher</li> <li>Django REST Framework 3.14 or higher</li> </ul>"},{"location":"getting-started/installation/#installation-via-pip","title":"Installation via pip","text":"<p>Install the latest stable release:</p> <p>Using uv</p> <pre><code>uv add drf-restflow\n</code></pre> <pre><code>pip install drf-restflow\n</code></pre>"},{"location":"getting-started/installation/#optional-dependencies","title":"Optional Dependencies","text":""},{"location":"getting-started/installation/#postgresql-support","title":"PostgreSQL Support","text":"<p>For PostgreSQL-specific features (array fields, full-text search, etc.):</p> <pre><code>pip install drf-restflow psycopg2-binary\n</code></pre> <p>Or if you're already using PostgreSQL with Django, <code>drf-restflow</code> will automatically detect it.</p>"},{"location":"getting-started/installation/#verifying-installation","title":"Verifying Installation","text":"<p>Verify the installation by importing the package:</p> <pre><code>import restflow\nprint(restflow.__version__)\n</code></pre>"},{"location":"getting-started/installation/#django-configuration","title":"Django Configuration","text":"<p>No special configuration is needed in Django settings. <code>drf-restflow</code> works out of the box with any Django project that has DRF installed.</p> <p>However, you may want to configure DRF settings if you haven't already:</p> <pre><code># settings.py\n\nINSTALLED_APPS = [\n    ...\n    'rest_framework',\n    ...\n]\n\nREST_FRAMEWORK = {\n    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',\n    'PAGE_SIZE': 100,\n    # Other DRF settings...\n}\n</code></pre>"},{"location":"getting-started/installation/#compatibility-matrix","title":"Compatibility Matrix","text":"Python Django DRF drf-restflow 3.10 3.2-5.1 3.14+ 1.0.0a1 3.11 3.2-5.1 3.14+ 1.0.0a1 3.12 4.0-5.2 3.14+ 1.0.0a1 3.13 4.2-5.2 3.14+ 1.0.0a1 3.14 5.1-5.2 3.14+ 1.0.0a1"},{"location":"getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/installation/#import-error","title":"Import Error","text":"<p>If you get an import error:</p> <pre><code>ImportError: No module named 'restflow'\n</code></pre> <p>Make sure you've installed the package in the correct environment:</p> <pre><code>pip list | grep drf-restflow\n</code></pre>"},{"location":"getting-started/installation/#version-conflicts","title":"Version Conflicts","text":"<p>If you encounter version conflicts with Django or DRF:</p> <pre><code># Check current versions\npip show django djangorestframework\n\n# Upgrade if needed\npip install --upgrade django djangorestframework\n</code></pre>"},{"location":"getting-started/installation/#whats-next","title":"What's Next?","text":"<p>Now that you've installed <code>drf-restflow</code>, explore the available features:</p> <p>Understanding drf-restflow: - \ud83d\udcd6 Basic Concepts - Learn the library's philosophy and design principles - \ud83d\udcda Filtering Tutorial - Complete walkthrough of filtering features</p>"},{"location":"getting-started/quickstart/","title":"Quick Start","text":"<p>This guide will help you get started with <code>drf-restflow</code>.</p>"},{"location":"getting-started/quickstart/#about-this-guide","title":"About This Guide","text":"<p><code>drf-restflow</code> is a declarative library for Django REST Framework with multiple planned features. This quickstart focuses on Filtering - the first available feature.</p> <p>What you'll learn: - Creating FilterSets with type annotations - Integrating filters into DRF views - Using query parameters for filtering and ordering</p> <p>Future releases will add: - Declarative Annotated Serializer - FastAPI-Style Views - Advanced Caching</p> <p>Let's build your first FilterSet!</p>"},{"location":"getting-started/quickstart/#prerequisites","title":"Prerequisites","text":"<p>Make sure you have:</p> <ul> <li>Django and DRF installed and configured</li> <li>A Django model to filter</li> <li>Basic understanding of Django REST Framework</li> </ul>"},{"location":"getting-started/quickstart/#examples","title":"Examples","text":"<p>Let's quickly view the features of drf-restflow</p>"},{"location":"getting-started/quickstart/#filterset","title":"FilterSet","text":"<p>Filterset helps you create a filter domain and helps filter queryset. </p>"},{"location":"getting-started/quickstart/#define-your-model","title":"Define Your Model","text":"<p>Let's start with a simple Product model:</p> <pre><code># models.py\nfrom django.db import models\n\nclass Product(models.Model):\n    name = models.CharField(max_length=200)\n    description = models.TextField()\n    price = models.DecimalField(max_digits=10, decimal_places=2)\n    category = models.CharField(max_length=100)\n    in_stock = models.BooleanField(default=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n\n    def __str__(self):\n        return self.name\n</code></pre>"},{"location":"getting-started/quickstart/#create-a-filterset","title":"Create a FilterSet","text":"<p>Now create a FilterSet to enable filtering:</p> <pre><code># filters.py\nfrom restflow.filters import FilterSet, StringField, IntegerField, BooleanField\n\nclass ProductFilterSet(FilterSet):\n    # Explicit field declarations with lookups\n    name = StringField(lookups=[\"icontains\"])\n    price = IntegerField(lookups=[\"comparison\"])  # gt, gte, lt, lte\n\n    # Type annotation style\n    category: str\n    in_stock: bool\n\n    class Meta:\n        model = Product\n        order_fields = [(\"price\", \"price\"), (\"name\", \"name\"), (\"created_at\", \"created_at\")]\n</code></pre>"},{"location":"getting-started/quickstart/#use-in-a-view","title":"Use in a View","text":""},{"location":"getting-started/quickstart/#function-based-view","title":"Function-Based View","text":"<pre><code># views.py\nfrom rest_framework.decorators import api_view\nfrom rest_framework.response import Response\nfrom .filters import ProductFilterSet\nfrom .models import Product\n\n@api_view(['GET'])\ndef product_list(request):\n    # Get base queryset\n    queryset = Product.objects.all()\n\n    # Apply filters\n    filterset = ProductFilterSet(request=request)\n    filtered_queryset = filterset.filter_queryset(queryset)\n\n    # Return response\n    return Response({\n        'count': filtered_queryset.count(),\n        'results': list(filtered_queryset.values())\n    })\n</code></pre>"},{"location":"getting-started/quickstart/#class-based-view","title":"Class-Based View","text":"<pre><code># views.py\nfrom rest_framework.views import APIView\nfrom rest_framework.response import Response\nfrom .filters import ProductFilterSet\nfrom .models import Product\n\nclass ProductListView(APIView):\n    def get(self, request):\n        queryset = Product.objects.all()\n        filterset = ProductFilterSet(request=request)\n        filtered_queryset = filterset.filter_queryset(queryset)\n\n        return Response({\n            'count': filtered_queryset.count(),\n            'results': list(filtered_queryset.values())\n        })\n</code></pre>"},{"location":"getting-started/quickstart/#with-drf-generic-views","title":"With DRF Generic Views","text":"<pre><code># views.py\nfrom rest_framework import generics\nfrom .filters import ProductFilterSet\nfrom .models import Product\nfrom .serializers import ProductSerializer\n\nclass ProductListAPIView(generics.ListAPIView):\n    queryset = Product.objects.all()\n    serializer_class = ProductSerializer\n\n    def get_queryset(self):\n        queryset = super().get_queryset()\n        filterset = ProductFilterSet(request=self.request)\n        return filterset.filter_queryset(queryset)\n</code></pre>"},{"location":"getting-started/quickstart/#add-url-pattern","title":"Add URL Pattern","text":"<pre><code># urls.py\nfrom django.urls import path\nfrom .views import product_list\n\nurlpatterns = [\n    path('products/', product_list, name='product-list'),\n]\n</code></pre>"},{"location":"getting-started/quickstart/#test-your-api","title":"Test Your API","text":"<p>Now you can filter products using query parameters:</p>"},{"location":"getting-started/quickstart/#basic-filtering","title":"Basic Filtering","text":"<pre><code># Get all products\nGET /api/products/\n\n# Filter by exact category\nGET /api/products?category=electronics\n\n# Filter by name containing \"laptop\"\nGET /api/products?name__icontains=laptop\n\n# Filter in-stock products\nGET /api/products?in_stock=true\n</code></pre>"},{"location":"getting-started/quickstart/#range-filtering","title":"Range Filtering","text":"<pre><code># Products with price greater than or equal to 100\nGET /api/products?price__gte=100\n\n# Products with price less than 500\nGET /api/products?price__lt=500\n\n# Products in price range 100-500\nGET /api/products?price__gte=100&amp;price__lte=500\n</code></pre>"},{"location":"getting-started/quickstart/#negation-exclusion","title":"Negation (Exclusion)","text":"<pre><code># Exclude electronics category\nGET /api/products?category!=electronics\n\n# Products NOT named \"laptop\"\nGET /api/products?name!=laptop\n\n# Out of stock products\nGET /api/products?in_stock!=true\n</code></pre>"},{"location":"getting-started/quickstart/#ordering","title":"Ordering","text":"<pre><code># Order by price ascending\nGET /api/products?order_by=price\n\n# Order by price descending\nGET /api/products?order_by=-price\n\n# Order by multiple fields\nGET /api/products?order_by=category,-price\n</code></pre>"},{"location":"getting-started/quickstart/#combined-filtering","title":"Combined Filtering","text":"<pre><code># Complex filter: laptops under $1000, in stock, ordered by price\nGET /api/products?name__icontains=laptop&amp;price__lte=1000&amp;in_stock=true&amp;order_by=price\n</code></pre>"},{"location":"getting-started/quickstart/#understanding-the-generated-fields","title":"Understanding the Generated Fields","text":"<p>The FilterSet automatically generates multiple filter fields:</p> Declaration Generated Fields <code>name = StringField(lookups=[\"icontains\"])</code> <code>name</code>, <code>name__icontains</code>, <code>name!</code>, <code>name__icontains!</code> <code>price = IntegerField(lookups=[\"comparison\"])</code> <code>price</code>, <code>price__gt</code>, <code>price__gte</code>, <code>price__lt</code>, <code>price__lte</code>, <code>price!</code>, <code>price__gt!</code>, ... <code>category: str</code> <code>category</code>, <code>category!</code> <code>in_stock: bool</code> <code>in_stock</code>, <code>in_stock!</code>"},{"location":"getting-started/quickstart/#validation","title":"Validation","text":"<p>The FilterSet automatically validates query parameters:</p> <pre><code># Invalid integer\nGET /api/products?price__gte=invalid\n# Response: {\"price__gte\": [\"A valid integer is required.\"]}\n\n# Invalid boolean\nGET /api/products?in_stock=maybe\n# Response: {\"in_stock\": [\"Must be a valid boolean.\"]}\n</code></pre>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<p>Congratulations! You've created your first FilterSet with drf-restflow. Here's what to explore next:</p> <p>Dive Deeper into Filtering: - Basic Concepts - Understand the library's philosophy - Filtering Tutorial - Complete walkthrough with real examples - FilterSet Guide - Comprehensive FilterSet documentation - Fields Guide - All field types, lookups, and PostgreSQL features</p> <p>Stay Updated: - Watch the GitHub repository for new releases - Future features: Declarative Annotations, FastAPI-Style Views, Advanced Caching</p>"},{"location":"guide/","title":"Guide Overview","text":"<p>The guide currently focuses on the FilterSet feature.</p> Feature Description Link FilterSet Declarative filters with Meta options, lookup generation/negation, operators, preprocessors/postprocessors, ordering, validation, and PostgreSQL extras. FilterSet guide"},{"location":"guide/filtering/fields/","title":"Fields","text":"<p>Complete guide to all field types, lookups, type annotations, PostgreSQL features, and every nitpick detail about fields in drf-restflow.</p>"},{"location":"guide/filtering/fields/#quick-navigation","title":"Quick Navigation","text":""},{"location":"guide/filtering/fields/#getting-started","title":"Getting Started","text":"<ul> <li>Field Basics - How to declare and use fields</li> <li>Type Annotations - Automatic field generation with Python types</li> </ul>"},{"location":"guide/filtering/fields/#field-types-by-category","title":"Field Types by Category","text":"<p>Basic Fields - StringField - Text filtering with text lookups - IntegerField - Integer filtering with comparison lookups - FloatField - Floating-point number filtering - BooleanField - True/False filtering</p> <p>Numeric Fields - DecimalField - Precise decimal number filtering</p> <p>Date &amp; Time Fields - DateField - Date filtering with year/month/day lookups - DateTimeField - DateTime filtering with timestamp lookups - TimeField - Time-only filtering</p> <p>Choice Fields - ChoiceField - Single choice from predefined options - MultipleChoiceField - Multiple choices from options</p> <p>Collection Fields - ListField - List/array filtering with <code>__in</code> lookup</p> <p>Ordering - OrderField - Sorting and ordering results</p> <p>Relational Fields - RelatedField - Filters across relationship fields in django model</p> <p>PostgreSQL Fields - Full-Text Search - SearchVector and SearchQuery - Array Fields - PostgreSQL array operations - JSON Fields - JSONField filtering - Range Fields - Date/Integer ranges - Trigram Search - Fuzzy text matching</p>"},{"location":"guide/filtering/fields/#advanced-topics","title":"Advanced Topics","text":"<ul> <li>Lookups - Lookup variations and categories</li> <li>Negation - <code>!</code> suffix for NOT operations</li> <li>Custom Lookup Expressions - Related field filtering</li> <li>Validation - Field validation and error handling</li> <li>Field Parameters Reference - Complete parameter lists</li> <li>Important Caveats - Common pitfalls and warnings</li> <li>Best Practices - Recommended patterns</li> </ul>"},{"location":"guide/filtering/fields/#field-basics","title":"Field Basics","text":"<p>Fields define what query parameters your FilterSet accepts and how they filter the queryset.</p>"},{"location":"guide/filtering/fields/#three-ways-to-declare-fields","title":"Three Ways to Declare Fields","text":"<pre><code>from restflow.filters import FilterSet, StringField\n\nclass ProductFilterSet(FilterSet):\n    # 1. Type annotation (simplest)\n    name: str\n\n    # 2. Explicit field\n    description = StringField(lookups=[\"icontains\"])\n\n    # 3. Model-based with extra_kwargs\n    class Meta:\n        model = Product\n        fields = ['price']\n        extra_kwargs = {\n            'price': {'min_value': 0}\n        }\n</code></pre>"},{"location":"guide/filtering/fields/#field-generation","title":"Field Generation","text":"<p>Each field can generate multiple filter parameters:</p> <pre><code>class ProductFilterSet(FilterSet):\n    price = IntegerField(lookups=[\"comparison\"])\n\n# Generates:\n# - price           (exact match)\n# - price__gt       (greater than)\n# - price__gte      (greater than or equal)\n# - price__lt       (less than)\n# - price__lte      (less than or equal)\n# - price!          (not equal - negation)\n# - price__gt!      (not greater than)\n# - price__gte!     (not greater than or equal)\n# - price__lt!      (not less than)\n# - price__lte!     (not less than or equal)\n</code></pre>"},{"location":"guide/filtering/fields/#type-annotations","title":"Type Annotations","text":"<p>Use Python type annotations for automatic field generation.</p>"},{"location":"guide/filtering/fields/#basic-types","title":"Basic Types","text":"<pre><code>from typing import List, Literal\nfrom datetime import datetime, date, time\nfrom decimal import Decimal\n\nclass ProductFilterSet(FilterSet):\n    # String \u2192 StringField\n    name: str\n    description: str\n\n    # Integer \u2192 IntegerField\n    quantity: int\n    views: int\n\n    # Float \u2192 FloatField\n    rating: float\n    score: float\n\n    # Boolean \u2192 BooleanField\n    in_stock: bool\n    is_featured: bool\n\n    # Decimal \u2192 DecimalField\n    price: Decimal\n\n    # Date/Time \u2192 DateField/DateTimeField/TimeField\n    created_date: date\n    created_at: datetime\n    opening_time: time\n</code></pre>"},{"location":"guide/filtering/fields/#choice-types-with-literal","title":"Choice Types with Literal","text":"<pre><code>from typing import Literal\n\nclass ProductFilterSet(FilterSet):\n    # ChoiceField\n    status: Literal[\"draft\", \"published\", \"archived\"]\n\n    # Also works with numbers\n    priority: Literal[1, 2, 3, 4, 5]\n</code></pre>"},{"location":"guide/filtering/fields/#list-types","title":"List Types","text":"<pre><code>from typing import List\n\nclass ProductFilterSet(FilterSet):\n    # ListField with IntegerField child\n    tags: List[int]\n\n    # ListField with StringField child\n    categories: List[str]\n\n    # Can specify lookup expression\n    tag_ids: List[int]  # Becomes tags__in by default\n</code></pre>"},{"location":"guide/filtering/fields/#optional-types","title":"Optional Types","text":"<pre><code>from typing import Optional\n\nclass ProductFilterSet(FilterSet):\n    # Optional fields (not required)\n    category: Optional[str]\n    brand: Optional[int]\n\n    # Or Modern style\n    price : int | None\n</code></pre>"},{"location":"guide/filtering/fields/#all-field-types","title":"All Field Types","text":""},{"location":"guide/filtering/fields/#stringfield","title":"StringField","text":"<p>For text filtering.</p> <pre><code>from restflow.filters import StringField\n\nclass ProductFilterSet(FilterSet):\n    # Basic string field\n    name = StringField()\n\n    # With lookups\n    title = StringField(lookups=[\"icontains\", \"istartswith\"])\n\n    # With validation\n    sku = StringField(\n        min_length=3,\n        max_length=20,\n        required=True\n    )\n\n    # Custom lookup expression\n    category_name = StringField(lookup_expr=\"category__name__icontains\")\n</code></pre> <p>Available lookups: - <code>exact</code>: Exact match (default) - <code>iexact</code>: Case-insensitive exact match - <code>contains</code>: Contains substring - <code>icontains</code>: Case-insensitive contains - <code>startswith</code>: Starts with - <code>istartswith</code>: Case-insensitive starts with - <code>endswith</code>: Ends with - <code>iendswith</code>: Case-insensitive ends with - <code>regex</code>: Regular expression - <code>iregex</code>: Case-insensitive regex</p> <p>Lookup category: - <code>text</code>: Expands to <code>icontains</code>, <code>contains</code>, <code>startswith</code>, <code>endswith</code>, <code>iexact</code></p> <p>Parameters: - <code>min_length</code>: Minimum string length - <code>max_length</code>: Maximum string length - <code>required</code>: Make field required - <code>validators</code>: List of custom validators - <code>help_text</code>: Description - <code>trim_whitespace</code>: Remove leading/trailing whitespace (default: True) - <code>allow_blank</code>: Allow empty strings - <code>lookups</code>: List of lookup variations - <code>lookup_expr</code>: Custom Django ORM lookup expression - <code>method</code>: Custom filter method</p>"},{"location":"guide/filtering/fields/#integerfield","title":"IntegerField","text":"<p>For integer number filtering.</p> <pre><code>from restflow.filters import IntegerField\n\nclass ProductFilterSet(FilterSet):\n    # Basic integer field\n    quantity: int\n\n    # With lookups\n    price = IntegerField(lookups=[\"comparison\"])\n    # Creates: price, price__gt, price__gte, price__lt, price__lte\n\n    # With validation\n    stock = IntegerField(\n        min_value=0,\n        max_value=10000,\n        required=False\n    )\n\n    # Related field\n    category_id = IntegerField(lookup_expr=\"category__id\")\n</code></pre> <p>Available lookups: - <code>exact</code>: Exact match (default) - <code>gt</code>: Greater than - <code>gte</code>: Greater than or equal - <code>lt</code>: Less than - <code>lte</code>: Less than or equal - <code>in</code>: In list - <code>range</code>: Between two values</p> <p>Lookup category: - <code>comparison</code>: Expands to <code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code></p> <p>Parameters: - <code>min_value</code>: Minimum allowed value - <code>max_value</code>: Maximum allowed value - <code>required</code>: Make field required - <code>validators</code>: List of custom validators - <code>help_text</code>: Description - <code>lookups</code>: List of lookup variations - <code>lookup_expr</code>: Custom lookup expression - <code>method</code>: Custom filter method</p>"},{"location":"guide/filtering/fields/#floatfield","title":"FloatField","text":"<p>For floating-point number filtering.</p> <pre><code>from restflow.filters import FloatField\n\nclass ProductFilterSet(FilterSet):\n    # Basic float field\n    rating: float\n\n    # With lookups\n    score = FloatField(lookups=[\"comparison\"])\n\n    # With validation\n    discount = FloatField(\n        min_value=0.0,\n        max_value=100.0\n    )\n\n    # Average rating (annotated field)\n    min_rating = FloatField(\n        method=\"filter_min_rating\",\n        min_value=0.0,\n        max_value=5.0\n    )\n</code></pre> <p>Available lookups: - <code>exact</code>: Exact match (default) - <code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code>: Comparison - <code>range</code>: Between two values</p> <p>Lookup category: - <code>comparison</code>: Expands to <code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code></p> <p>Parameters: - <code>min_value</code>: Minimum value - <code>max_value</code>: Maximum value - <code>required</code>: Make field required - <code>validators</code>: List of validators - <code>help_text</code>: Description - <code>lookups</code>: Lookup variations - <code>lookup_expr</code>: Custom lookup - <code>method</code>: Custom method</p>"},{"location":"guide/filtering/fields/#booleanfield","title":"BooleanField","text":"<p>For boolean filtering.</p> <pre><code>from restflow.filters import BooleanField\n\nclass ProductFilterSet(FilterSet):\n    # Basic boolean\n    in_stock: bool\n\n    # Explicit declaration\n    is_featured = BooleanField()\n\n    # With custom method\n    available = BooleanField(method=\"filter_available\")\n\n    # Required boolean\n    active = BooleanField(required=True)\n</code></pre> <p>Accepts values: - True: <code>true</code>, <code>True</code>, <code>1</code>, <code>yes</code> - False: <code>false</code>, <code>False</code>, <code>0</code>, <code>no</code></p> <p>Available lookups: - <code>exact</code>: Exact match (default) - <code>isnull</code>: Check if null</p> <p>Parameters: - <code>required</code>: Make field required - <code>help_text</code>: Description - <code>lookup_expr</code>: Custom lookup - <code>method</code>: Custom method</p>"},{"location":"guide/filtering/fields/#decimalfield","title":"DecimalField","text":"<p>For precise decimal number filtering (e.g., money).</p> <pre><code>from restflow.filters import DecimalField\n\nclass ProductFilterSet(FilterSet):\n    # Basic decimal\n    price = DecimalField(\n        max_digits=10,\n        decimal_places=2\n    )\n\n    # With lookups and validation\n    amount = DecimalField(\n        max_digits=10,\n        decimal_places=2,\n        min_value=0,\n        lookups=[\"comparison\"]\n    )\n</code></pre> <p>Available lookups: - <code>exact</code>, <code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code>, <code>range</code></p> <p>Lookup category: - <code>comparison</code></p> <p>Parameters: - <code>max_digits</code>: Total digits (including decimal places) - <code>decimal_places</code>: Number of decimal places - <code>min_value</code>, <code>max_value</code>: Validation - <code>required</code>, <code>validators</code>, <code>help_text</code>, <code>lookups</code>, <code>lookup_expr</code>, <code>method</code></p>"},{"location":"guide/filtering/fields/#datefield","title":"DateField","text":"<p>For date filtering.</p> <pre><code>from restflow.filters import DateField\n\nclass ProductFilterSet(FilterSet):\n    # Basic date\n    created_date: date\n\n    # With lookups\n    published_date = DateField(lookups=[\"comparison\"])\n    # Creates: published_date, published_date__gt, __gte, __lt, __lte\n\n    # Date range\n    start_date = DateField(lookup_expr=\"created_at__date__gte\")\n    end_date = DateField(lookup_expr=\"created_at__date__lte\")\n</code></pre> <p>Accepts formats: - ISO 8601: <code>2024-01-15</code> - Other formats configured in DRF settings</p> <p>Available lookups: - <code>exact</code>, <code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code> - <code>year</code>, <code>month</code>, <code>day</code> - <code>week</code>, <code>week_day</code> - <code>quarter</code></p> <p>Lookup category: - <code>comparison</code></p> <p>Parameters: - <code>input_formats</code>: List of accepted date formats - <code>required</code>, <code>validators</code>, <code>help_text</code>, <code>lookups</code>, <code>lookup_expr</code>, <code>method</code></p>"},{"location":"guide/filtering/fields/#datetimefield","title":"DateTimeField","text":"<p>For datetime filtering.</p> <pre><code>from restflow.filters import DateTimeField\n\nclass ProductFilterSet(FilterSet):\n    # Basic datetime\n    created_at: datetime\n\n    # With lookups\n    published_at = DateTimeField(lookups=[\"comparison\"])\n\n    # With timezone support\n    updated_at = DateTimeField()\n</code></pre> <p>Accepts formats: - ISO 8601: <code>2024-01-15T10:30:00Z</code> - Other formats configured in DRF settings</p> <p>Available lookups: - Same as DateField plus time-specific - <code>hour</code>, <code>minute</code>, <code>second</code></p> <p>Lookup category: - <code>comparison</code></p> <p>Parameters: - <code>input_formats</code>: Accepted datetime formats - <code>default_timezone</code>: Timezone for naive datetimes - <code>required</code>, <code>validators</code>, <code>help_text</code>, <code>lookups</code>, <code>lookup_expr</code>, <code>method</code></p>"},{"location":"guide/filtering/fields/#timefield","title":"TimeField","text":"<p>For time filtering.</p> <pre><code>from restflow.filters import TimeField\n\nclass ProductFilterSet(FilterSet):\n    # Basic time\n    opening_time: time\n\n    # With lookups\n    closing_time = TimeField(lookups=[\"comparison\"])\n</code></pre> <p>Accepts formats: - <code>14:30:00</code> - <code>14:30</code></p> <p>Available lookups: - <code>exact</code>, <code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code> - <code>hour</code>, <code>minute</code>, <code>second</code></p> <p>Parameters: - <code>input_formats</code>, <code>required</code>, <code>validators</code>, <code>help_text</code>, <code>lookups</code>, <code>lookup_expr</code>, <code>method</code></p>"},{"location":"guide/filtering/fields/#choicefield","title":"ChoiceField","text":"<p>For fields with limited choices.</p> <pre><code>from restflow.filters import ChoiceField\n\nclass ProductFilterSet(FilterSet):\n    # Basic choices\n    status = ChoiceField(\n        choices=[\n            ('draft', 'Draft'),\n            ('published', 'Published'),\n            ('archived', 'Archived')\n        ]\n    )\n\n    # With Literal type annotation\n    priority: Literal[\"low\", \"medium\", \"high\", \"urgent\"]\n\n    # With tuple choices\n    size = ChoiceField(\n        choices=[\n            ('S', 'Small'),\n            ('M', 'Medium'),\n            ('L', 'Large'),\n            ('XL', 'Extra Large')\n        ]\n    )\n</code></pre> <p>Available lookups: - <code>exact</code> (default) - <code>in</code></p> <p>Parameters: - <code>choices</code>: List of (value, label) tuples or list of values - <code>required</code>, <code>help_text</code>, <code>lookups</code>, <code>lookup_expr</code>, <code>method</code></p>"},{"location":"guide/filtering/fields/#multiplechoicefield","title":"MultipleChoiceField","text":"<p>For selecting multiple choices.</p> <pre><code>from restflow.filters import MultipleChoiceField\n\nclass ProductFilterSet(FilterSet):\n    # Multiple statuses\n    statuses = MultipleChoiceField(\n        choices=[\n            ('draft', 'Draft'),\n            ('published', 'Published')\n        ],\n        lookup_expr=\"status__in\"\n    )\n\n    # Multiple categories\n    categories = MultipleChoiceField(\n        choices=[\n            ('electronics', 'Electronics'),\n            ('books', 'Books'),\n            ('clothing', 'Clothing')\n        ]\n    )\n</code></pre> <p>Accepts: - Comma-separated values: <code>?statuses=draft,published</code></p> <p>Available lookups: - <code>in</code> (default)</p> <p>Parameters: - <code>choices</code>: List of (value, label) tuples - <code>required</code>, <code>help_text</code>, <code>lookup_expr</code>, <code>method</code></p>"},{"location":"guide/filtering/fields/#listfield","title":"ListField","text":"<p>For filtering by list of values.</p> <pre><code>from restflow.filters import ListField, IntegerField, StringField\n\nclass ProductFilterSet(FilterSet):\n    # List of integers\n    tags: List[int]\n    # Auto-generates: tags__in\n\n    # Explicit declaration\n    tag_ids = ListField(\n        child=IntegerField(),\n        lookup_expr=\"tags__id__in\"\n    )\n\n    # List of strings\n    categories = ListField(\n        child=StringField(),\n        lookup_expr=\"category__name__in\"\n    )\n\n    # With validation\n    product_ids = ListField(\n        child=IntegerField(min_value=1),\n        min_length=1,\n        max_length=100\n    )\n</code></pre> <p>Accepts: - Comma-separated: <code>?tags=1,2,3</code> - Multiple params: <code>?tags=1&amp;tags=2&amp;tags=3</code></p> <p>Available lookups: - <code>in</code> (default) - <code>overlap</code> (PostgreSQL arrays) - <code>contains</code> (PostgreSQL arrays) - <code>contained_by</code> (PostgreSQL arrays)</p> <p>Lookup category: - <code>pg_array</code>: PostgreSQL array lookups</p> <p>Parameters: - <code>child</code>: Field type for list items - <code>min_length</code>: Minimum number of items - <code>max_length</code>: Maximum number of items - <code>required</code>, <code>help_text</code>, <code>lookups</code>, <code>lookup_expr</code>, <code>method</code></p>"},{"location":"guide/filtering/fields/#orderfield","title":"OrderField","text":"<p>For ordering/sorting.</p> <pre><code>from restflow.filters import OrderField\n\nclass ProductFilterSet(FilterSet):\n    ordering = OrderField(\n        fields=[\n            ('name', 'name'),\n            ('price', 'price'),\n            ('created_at', 'created_at')\n        ]\n    )\n\n# Usage:\n# ?ordering=name           # Ascending\n# ?ordering=-price         # Descending\n</code></pre> <p>Note: Usually defined in <code>Meta.order_fields</code> instead. See FilterSet guide.</p>"},{"location":"guide/filtering/fields/#relatedfield","title":"RelatedField","text":"<p>Filter across relationships:</p> <pre><code>from restflow.filters import RelatedField\n\nclass Product(models.Model):\n    name = models.CharField(max_length=200)\n    category = models.ForeignKey(Category, on_delete=models.CASCADE)\n\nclass Category(models.Model):\n    name = models.CharField(max_length=100)\n    description = models.TextField()\n    sku = models.CharField(max_length=12)\n\n# FilterSet with related fields\nclass ProductFilterSet(FilterSet):\n    category = RelatedField(\n        model=Category,\n        fields=[\"name\", \"description\"],\n        exclude=[\"sku\"]\n    )\n\n# Generates filters:\n# - category__name\n# - category__name__icontains (if lookups configured)\n# - category__description\n# - category__description__icontains\n\n# Usage\n?category__name=Electronics\n?category__name__icontains=elec\n</code></pre>"},{"location":"guide/filtering/fields/#lookups","title":"Lookups","text":"<p>Lookups allow creating variations of a field for different filter operations.</p>"},{"location":"guide/filtering/fields/#individual-lookups","title":"Individual Lookups","text":"<pre><code>class ProductFilterSet(FilterSet):\n    # Exact match only (default)\n    name: str\n\n    # Exact + contains\n    title = StringField(lookups=[\"exact\", \"icontains\"])\n    # Creates: title, title__icontains\n\n    # Comparison lookups\n    price = IntegerField(lookups=[\"gt\", \"gte\", \"lt\", \"lte\"])\n    # Creates: price__gt, price__gte, price__lt, price__lte\n\n    # Date lookups\n    created_at = DateTimeField(lookups=[\"gte\", \"lte\", \"year\", \"month\"])\n    # Creates: created_at__gte, created_at__lte, created_at__year, created_at__month\n</code></pre>"},{"location":"guide/filtering/fields/#lookup-categories","title":"Lookup Categories","text":"<p>Use predefined groups instead of listing individual lookups:</p> <pre><code>class ProductFilterSet(FilterSet):\n    # \"text\" category\n    name = StringField(lookups=[\"text\"])\n    # Expands to: icontains, contains, startswith, endswith, iexact\n\n    # \"comparison\" category\n    price = IntegerField(lookups=[\"comparison\"])\n    # Expands to: gt, gte, lt, lte\n\n    # \"pg_array\" category (PostgreSQL)\n    tags = ListField(child=StringField(), lookups=[\"pg_array\"])\n    # Expands to: contains, overlap, contained_by\n</code></pre> <p>Available categories:</p> <ul> <li><code>text</code> (StringField): <code>icontains</code>, <code>contains</code>, <code>startswith</code>, <code>endswith</code>, <code>iexact</code></li> <li><code>comparison</code> (Numeric/Date fields): <code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code></li> <li><code>pg_array</code> (PostgreSQL arrays): <code>contains</code>, <code>overlap</code>, <code>contained_by</code></li> <li><code>pg_json</code> (PostgreSQL JSON): JSON-specific lookups</li> </ul>"},{"location":"guide/filtering/fields/#all-django-lookup-expressions","title":"All Django Lookup Expressions","text":"<pre><code># Text lookups\nexact, iexact\ncontains, icontains\nstartswith, istartswith\nendswith, iendswith\nregex, iregex\n\n# Numeric/Date lookups\ngt, gte, lt, lte\nrange\nin\n\n# Null checks\nisnull\n\n# Date component lookups\nyear, month, day\nweek, week_day, quarter\nhour, minute, second\n\n# PostgreSQL-specific\ncontains (array/range)\ncontained_by (array/range)\noverlap (array/range)\nhas_key, has_keys, has_any_keys (JSON)\n\n# Geographic (GeoDjango)\ndistance_lt, distance_lte, distance_gt, distance_gte\ndwithin\n</code></pre>"},{"location":"guide/filtering/fields/#negation-with-lookups","title":"Negation with Lookups","text":"<p>Every lookup automatically gets a negation variant:</p> <pre><code>class ProductFilterSet(FilterSet):\n    price = IntegerField(lookups=[\"gte\", \"lte\"])\n\n# Generates:\n# price__gte      # Greater than or equal\n# price__gte!     # NOT greater than or equal\n# price__lte      # Less than or equal\n# price__lte!     # NOT less than or equal\n</code></pre>"},{"location":"guide/filtering/fields/#negation","title":"Negation","text":"<p>All fields automatically support negation with <code>!</code> suffix.</p>"},{"location":"guide/filtering/fields/#basic-negation","title":"Basic Negation","text":"<pre><code># ?status!=draft              # Status NOT draft\n# ?in_stock!=true            # NOT in stock\n# ?price!=1000               # Price NOT 1000\n</code></pre>"},{"location":"guide/filtering/fields/#negation-with-lookups_1","title":"Negation with Lookups","text":"<pre><code># ?price__gte!=100           # NOT (price &gt;= 100)  \u2192  price &lt; 100\n# ?name__icontains!=test     # Name does NOT contain \"test\"\n# ?created_at__year!=2024    # NOT created in 2024\n</code></pre>"},{"location":"guide/filtering/fields/#negation-examples","title":"Negation Examples","text":"<pre><code>class ProductFilterSet(FilterSet):\n    name = StringField(lookups=[\"icontains\"])\n    price = IntegerField(lookups=[\"comparison\"])\n    status: str\n\n# All work:\n# ?name!=laptop                  # Name not \"laptop\"\n# ?name__icontains!=wireless     # Name doesn't contain \"wireless\"\n# ?price!=99                     # Price not 99\n# ?price__gte!=1000             # Price NOT &gt;= 1000 (i.e., &lt; 1000)\n# ?status!=draft                # Status not draft\n</code></pre>"},{"location":"guide/filtering/fields/#multiple-negations","title":"Multiple Negations","text":"<pre><code># Combine multiple negations\n?status!=draft&amp;status!=archived&amp;in_stock!=false\n\n# With AND operator: NOT draft AND NOT archived AND in_stock\n</code></pre>"},{"location":"guide/filtering/fields/#custom-lookup-expressions","title":"Custom Lookup Expressions","text":"<p>Override the default lookup expression to filter by related fields or custom paths.</p>"},{"location":"guide/filtering/fields/#basic-custom-expressions","title":"Basic Custom Expressions","text":"<pre><code>class ProductFilterSet(FilterSet):\n    # Filter by related field\n    category_name = StringField(lookup_expr=\"category__name\")\n\n    # Case-insensitive related field\n    brand = StringField(lookup_expr=\"brand__name__iexact\")\n\n    # Multiple relationship levels\n    department = StringField(lookup_expr=\"category__department__name\")\n\n# Usage:\n# ?category_name=Electronics\n# ?brand=apple\n# ?department=Technology\n</code></pre>"},{"location":"guide/filtering/fields/#with-lookups","title":"With Lookups","text":"<pre><code>class ProductFilterSet(FilterSet):\n    # Base expression + lookups\n    category_name = StringField(\n        lookup_expr=\"category__name\",\n        lookups=[\"icontains\", \"istartswith\"]\n    )\n\n# Generates:\n# category_name__icontains       \u2192 category__name__icontains\n# category_name__istartswith     \u2192 category__name__istartswith\n</code></pre>"},{"location":"guide/filtering/fields/#nested-relationships","title":"Nested Relationships","text":"<pre><code># Models\nclass Region(models.Model):\n    name = models.CharField(max_length=100)\n\nclass City(models.Model):\n    name = models.CharField(max_length=100)\n    region = models.ForeignKey(Region, on_delete=models.CASCADE)\n\nclass Address(models.Model):\n    street = models.CharField(max_length=200)\n    city = models.ForeignKey(City, on_delete=models.CASCADE)\n\nclass Store(models.Model):\n    name = models.CharField(max_length=100)\n    address = models.ForeignKey(Address, on_delete=models.CASCADE)\n\nclass Product(models.Model):\n    name = models.CharField(max_length=200)\n    store = models.ForeignKey(Store, on_delete=models.CASCADE)\n\n# FilterSet\nclass ProductFilterSet(FilterSet):\n    # Traverse multiple relationships\n    region = StringField(lookup_expr=\"store__address__city__region__name\")\n    city = StringField(lookup_expr=\"store__address__city__name\")\n\n# Or Can be done using related field\n\n# Usage:\n# ?region=California\n# ?city=San Francisco\n</code></pre>"},{"location":"guide/filtering/fields/#date-component-lookups","title":"Date Component Lookups","text":"<pre><code>class ProductFilterSet(FilterSet):\n    # Filter by date components\n    created_year = IntegerField(lookup_expr=\"created_at__year\")\n    created_month = IntegerField(lookup_expr=\"created_at__month\")\n    created_day = IntegerField(lookup_expr=\"created_at__day\")\n\n    # Or with lookups\n    published_year = IntegerField(\n        lookup_expr=\"published_at__year\",\n        lookups=[\"gte\", \"lte\"]\n    )\n\n# Usage:\n# ?created_year=2024\n# ?created_month=6\n# ?published_year__gte=2020\n</code></pre>"},{"location":"guide/filtering/fields/#annotated-field-lookups","title":"Annotated Field Lookups","text":"<pre><code>from django.db.models import Count\n\ndef add_annotations(filterset, queryset):\n    return queryset.annotate(\n        review_count=Count('reviews'),\n        avg_rating=Avg('reviews__rating')\n    )\n\nclass ProductFilterSet(FilterSet):\n    # Filter by annotated fields\n    min_reviews = IntegerField(lookup_expr=\"review_count__gte\")\n    max_reviews = IntegerField(lookup_expr=\"review_count__lte\")\n\n    class Meta:\n        preprocessors = [add_annotations]\n\n# Usage:\n# ?min_reviews=10\n# ?max_reviews=100\n</code></pre>"},{"location":"guide/filtering/fields/#validation","title":"Validation","text":""},{"location":"guide/filtering/fields/#automatic-type-validation","title":"Automatic Type Validation","text":"<pre><code>class ProductFilterSet(FilterSet):\n    price: int        # Only accepts integers\n    rating: float     # Only accepts floats\n    in_stock: bool    # Only accepts true/false\n\n# Invalid input returns 400:\n# ?price=abc  \u2192  {\"price\": [\"A valid integer is required.\"]}\n# ?rating=xyz \u2192  {\"rating\": [\"A valid number is required.\"]}\n</code></pre>"},{"location":"guide/filtering/fields/#built-in-validators","title":"Built-in Validators","text":"<pre><code>from restflow.filters import StringField, IntegerField\n\nclass ProductFilterSet(FilterSet):\n    # Min/max value\n    price = IntegerField(min_value=0, max_value=1000000)\n\n    # Min/max length\n    sku = StringField(min_length=3, max_length=20)\n\n    # Required\n    category = StringField(required=True)\n\n# Validation errors:\n# ?price=-10      \u2192  {\"price\": [\"Ensure this value is &gt;= 0.\"]}\n# ?sku=ab         \u2192  {\"sku\": [\"Ensure this has at least 3 characters.\"]}\n# (no category)   \u2192  {\"category\": [\"This field is required.\"]}\n</code></pre>"},{"location":"guide/filtering/fields/#custom-validators","title":"Custom Validators","text":"<pre><code>from rest_framework.exceptions import ValidationError\n\ndef validate_positive_even(value):\n    if value &lt;= 0:\n        raise ValidationError(\"Must be positive\")\n    if value % 2 != 0:\n        raise ValidationError(\"Must be even\")\n\nclass ProductFilterSet(FilterSet):\n    batch_size = IntegerField(validators=[validate_positive_even])\n\n# ?batch_size=-2  \u2192  {\"batch_size\": [\"Must be positive\"]}\n# ?batch_size=3   \u2192  {\"batch_size\": [\"Must be even\"]}\n</code></pre>"},{"location":"guide/filtering/fields/#choice-validation","title":"Choice Validation","text":"<pre><code>class ProductFilterSet(FilterSet):\n    status = ChoiceField(\n        choices=[('draft', 'Draft'), ('published', 'Published')]\n    )\n\n# ?status=invalid  \u2192  {\"status\": [\"\\\"invalid\\\" is not a valid choice.\"]}\n</code></pre>"},{"location":"guide/filtering/fields/#list-validation","title":"List Validation","text":"<pre><code>class ProductFilterSet(FilterSet):\n    tags = ListField(\n        child=IntegerField(min_value=1),\n        min_length=1,\n        max_length=10\n    )\n\n# ?tags=           \u2192  {\"tags\": [\"This list may not be empty.\"]}\n# ?tags=1,2,...,20 \u2192  {\"tags\": [\"Ensure this list has at most 10 elements.\"]}\n# ?tags=0,1        \u2192  {\"tags\": {\"0\": [\"Ensure &gt;= 1\"]}}\n</code></pre>"},{"location":"guide/filtering/fields/#postgresql-fields","title":"PostgreSQL Fields","text":""},{"location":"guide/filtering/fields/#full-text-search","title":"Full-Text Search","text":"<pre><code>from django.contrib.postgres.search import SearchVector, SearchQuery, SearchRank\n\nclass ProductFilterSet(FilterSet):\n    search = StringField(method=\"filter_fulltext\")\n\n    def filter_fulltext(self, filterset, queryset, value):\n        vector = SearchVector('name', weight='A') + \\\n                 SearchVector('description', weight='B')\n        query = SearchQuery(value)\n\n        return queryset.annotate(\n            search=vector,\n            rank=SearchRank(vector, query)\n        ).filter(search=query).order_by('-rank')\n\n# Usage:\n# ?search=wireless headphones\n</code></pre> <p>Weighted Search:</p> <pre><code>def filter_weighted_search(self, filterset, queryset, value):\n    # Weight: A (highest) &gt; B &gt; C &gt; D (lowest)\n    vector = \\\n        SearchVector('title', weight='A') + \\\n        SearchVector('description', weight='B') + \\\n        SearchVector('tags', weight='C')\n\n    query = SearchQuery(value)\n\n    return queryset.annotate(\n        rank=SearchRank(vector, query)\n    ).filter(search=vector_for_filter).order_by('-rank')\n</code></pre> <p>Search Configuration:</p> <pre><code>from django.contrib.postgres.search import SearchVector\n\n# English search configuration\nvector = SearchVector('description', config='english')\n\n# Different languages\nvector = SearchVector('description', config='spanish')\n</code></pre>"},{"location":"guide/filtering/fields/#array-fields","title":"Array Fields","text":"<pre><code>from django.contrib.postgres.fields import ArrayField\n\n# Model\nclass Product(models.Model):\n    tags = ArrayField(models.CharField(max_length=50))\n    sizes = ArrayField(models.CharField(max_length=10))\n\n# FilterSet\nclass ProductFilterSet(FilterSet):\n    # Basic array filtering\n    tags = ListField(\n        child=StringField(),\n        lookups=[\"pg_array\"]\n    )\n\n# Available lookups:\n# ?tags__contains=wireless        # Array contains value\n# ?tags__overlap=a,b,c           # Array overlaps with list\n# ?tags__contained_by=a,b,c,d    # Array is subset of list\n</code></pre> <p>Array Operations:</p> <pre><code># Contains (array must contain ALL values)\n?tags__contains=wireless\n\n# Overlaps (array has ANY of these values)\n?tags__overlap=wireless,bluetooth\n\n# Contained by (array is subset of these values)\n?tags__contained_by=wireless,bluetooth,usb,hdmi\n</code></pre> <p>All Tags (AND logic):</p> <pre><code>class ProductFilterSet(FilterSet):\n    all_tags = ListField(child=StringField(), method=\"filter_all_tags\")\n\n    def filter_all_tags(self, filterset, queryset, value):\n        \"\"\"Product must have ALL specified tags\"\"\"\n        q = Q()\n        for tag in value:\n            q &amp;= Q(tags__contains=[tag])\n        return q\n\n# ?all_tags=wireless,bluetooth  # Must have BOTH\n</code></pre>"},{"location":"guide/filtering/fields/#json-fields","title":"JSON Fields","text":"<pre><code>from django.db import models\n\n# Model\nclass Product(models.Model):\n    metadata = models.JSONField()\n    # Example: {\"brand\": \"Apple\", \"specs\": {\"color\": \"red\", \"size\": \"large\"}}\n\n# FilterSet\nclass ProductFilterSet(FilterSet):\n    # Filter by JSON keys\n    brand = StringField(lookup_expr=\"metadata__brand\")\n\n    # Nested JSON keys\n    color = StringField(lookup_expr=\"metadata__specs__color\")\n    size = StringField(lookup_expr=\"metadata__specs__size\")\n\n    # JSON contains\n    has_spec = StringField(lookup_expr=\"metadata__has_key\")\n\n# Usage:\n# ?brand=Apple\n# ?color=red\n# ?has_spec=warranty\n</code></pre> <p>JSON Lookups:</p> <pre><code># Has key\n?metadata__has_key=warranty\n\n# Has all keys\n?metadata__has_keys=warranty,certificate\n\n# Has any keys\n?metadata__has_any_keys=warranty,certificate\n\n# Contains (exact match)\n?metadata__contains={\"brand\": \"Apple\"}\n</code></pre>"},{"location":"guide/filtering/fields/#range-fields-postgresql","title":"Range Fields (PostgreSQL)","text":"<pre><code>from django.contrib.postgres.fields import IntegerRangeField, DateRangeField\n\n# Model\nclass Product(models.Model):\n    price_range = IntegerRangeField()\n    available_dates = DateRangeField()\n\n# FilterSet\nclass ProductFilterSet(FilterSet):\n    # Contains value\n    min_price = IntegerField(method=\"filter_price_contains\")\n\n    def filter_price_contains(self, filterset, queryset, value):\n        return queryset.filter(price_range__contains=value)\n\n# ?min_price=100  # Products with price range containing 100\n</code></pre>"},{"location":"guide/filtering/fields/#trigram-similarity-postgresql","title":"Trigram Similarity (PostgreSQL)","text":"<pre><code>from django.contrib.postgres.search import TrigramSimilarity\n\nclass ProductFilterSet(FilterSet):\n    fuzzy_name = StringField(method=\"filter_fuzzy_name\")\n\n    def filter_fuzzy_name(self, filterset, queryset, value):\n        return queryset.annotate(\n            similarity=TrigramSimilarity('name', value)\n        ).filter(similarity__gt=0.3).order_by('-similarity')\n\n# ?fuzzy_name=lapto  # Finds \"laptop\" with typo\n</code></pre>"},{"location":"guide/filtering/fields/#field-parameters-reference","title":"Field Parameters Reference","text":""},{"location":"guide/filtering/fields/#common-parameters-all-fields","title":"Common Parameters (All Fields)","text":"<pre><code>Field(\n    # Lookup configuration\n    lookups=[...],              # List of lookup expressions to generate\n    lookup_expr=\"...\",          # Custom Django ORM lookup expression\n\n    # Validation\n    required=False,             # Make field required\n    allow_null=False,           # Allow null values\n    validators=[...],           # List of validator functions\n\n    # Documentation\n    help_text=\"...\",            # Field description\n    label=\"...\",                # Field label\n\n    # Custom filtering\n    method=\"method_name\",       # Custom filter method\n)\n</code></pre>"},{"location":"guide/filtering/fields/#stringfield-parameters","title":"StringField Parameters","text":"<pre><code>StringField(\n    min_length=None,            # Minimum string length\n    max_length=None,            # Maximum string length\n    trim_whitespace=True,       # Remove leading/trailing whitespace\n    allow_blank=False,          # Allow empty strings\n\n    # Common parameters\n    lookups, lookup_expr, required, validators, help_text, method\n)\n</code></pre>"},{"location":"guide/filtering/fields/#integerfield-floatfield-decimalfield-parameters","title":"IntegerField / FloatField / DecimalField Parameters","text":"<pre><code>IntegerField(\n    min_value=None,             # Minimum value\n    max_value=None,             # Maximum value\n\n    # Common parameters\n    lookups, lookup_expr, required, validators, help_text, method\n)\n\nDecimalField(\n    max_digits=None,            # Total digits (required)\n    decimal_places=None,        # Decimal places (required)\n    min_value=None,\n    max_value=None,\n    # ...\n)\n</code></pre>"},{"location":"guide/filtering/fields/#datefield-datetimefield-timefield-parameters","title":"DateField / DateTimeField / TimeField Parameters","text":"<pre><code>DateTimeField(\n    input_formats=None,         # List of accepted input formats\n    default_timezone=None,      # Timezone for naive datetimes\n    format=None,                # Output format\n\n    # Common parameters\n    lookups, lookup_expr, required, validators, help_text, method\n)\n</code></pre>"},{"location":"guide/filtering/fields/#choicefield-multiplechoicefield-parameters","title":"ChoiceField / MultipleChoiceField Parameters","text":"<pre><code>ChoiceField(\n    choices=[...],              # List of (value, label) tuples (required)\n    allow_blank=False,          # Allow empty selection\n\n    # Common parameters\n    lookup_expr, required, help_text, method\n)\n</code></pre>"},{"location":"guide/filtering/fields/#listfield-parameters","title":"ListField Parameters","text":"<pre><code>ListField(\n    child=Field(),              # Child field type (required)\n    min_length=None,            # Minimum list length\n    max_length=None,            # Maximum list length\n    allow_empty=True,           # Allow empty list\n\n    # Common parameters\n    lookups, lookup_expr, required, help_text, method\n)\n</code></pre>"},{"location":"guide/filtering/fields/#important-caveats","title":"Important Caveats","text":""},{"location":"guide/filtering/fields/#custom-method-with-fields","title":"Custom Method with Fields","text":"<p>When using <code>method</code> parameter, return Q objects for operator compatibility:</p> <pre><code>class ProductFilterSet(FilterSet):\n    in_stock = BooleanField(method=\"filter_in_stock\")\n\n    class Meta:\n        operator = \"OR\"\n\n    # \u2705 CORRECT - Returns Q object\n    def filter_in_stock(self, filterset, queryset, value):\n        if value:\n            return Q(inventory__gt=0)\n        return Q()\n\n    # \u274c WRONG - Returns QuerySet (operator ignored)\n    def filter_in_stock_wrong(self, filterset, queryset, value):\n        if value:\n            return queryset.filter(inventory__gt=0)\n        return queryset\n</code></pre> <p>See FilterSet guide for details.</p>"},{"location":"guide/filtering/fields/#type-annotation-limitations","title":"Type Annotation Limitations","text":"<p>Type annotations can't express all configurations:</p> <pre><code># \u274c Can't add validation with type annotation\nprice: int  # No min/max\n\n# \u2705 Use explicit declaration\nprice = IntegerField(min_value=0, max_value=1000000)\n</code></pre>"},{"location":"guide/filtering/fields/#list-field-caveats","title":"List Field Caveats","text":"<p>Comma-separated vs Multiple Parameters:</p> <pre><code>tags: List[int]\n\n# Both work:\n?tags=1,2,3           # Comma-separated\n?tags=1&amp;tags=2&amp;tags=3 # Multiple parameters\n\n# But behave differently with some backends\n</code></pre> <p>Empty Lists:</p> <pre><code># ?tags=  \u2192 Empty string, not empty list!\n# Validation error: \"A valid integer is required.\"\n\n# Solution: Use allow_empty=True and handle in method\ntags = ListField(child=IntegerField(), allow_empty=True, method=\"filter_tags\")\n\ndef filter_tags(self, filterset, queryset, value):\n    if not value:  # Empty list\n        return Q()\n    return Q(tags__id__in=value)\n</code></pre>"},{"location":"guide/filtering/fields/#negation-edge-cases","title":"Negation Edge Cases","text":"<p>Double Negation:</p> <pre><code># \u26a0\ufe0f Watch out for logic\n?price__gte!=1000  # NOT (price &gt;= 1000) \u2192 price &lt; 1000\n\n# Equivalent to:\n?price__lt=1000\n</code></pre> <p>Null Checks:</p> <pre><code># Check if null\n?field__isnull=true\n\n# Check if NOT null\n?field__isnull!=true  # or ?field__isnull=false\n</code></pre>"},{"location":"guide/filtering/fields/#best-practices","title":"Best Practices","text":""},{"location":"guide/filtering/fields/#use-type-annotations-for-simple-fields","title":"Use Type Annotations for Simple Fields","text":"<pre><code># Clean and readable\nclass ProductFilterSet(FilterSet):\n    name: str\n    price: int\n    in_stock: bool\n</code></pre>"},{"location":"guide/filtering/fields/#use-explicit-declarations-for-complex-fields","title":"Use Explicit Declarations for Complex Fields","text":"<pre><code># Clear and configurable\nclass ProductFilterSet(FilterSet):\n    name = StringField(\n        lookups=[\"icontains\", \"istartswith\"],\n        min_length=2,\n        help_text=\"Product name search\"\n    )\n</code></pre>"},{"location":"guide/filtering/fields/#use-lookup-categories","title":"Use Lookup Categories","text":"<pre><code># Concise\nprice = IntegerField(lookups=[\"comparison\"])\n\n# Verbose\nprice = IntegerField(lookups=[\"gt\", \"gte\", \"lt\", \"lte\"])\n</code></pre>"},{"location":"guide/filtering/fields/#use-extra_kwargs-for-model-fields","title":"Use extra_kwargs for Model Fields","text":"<pre><code># Maintainable\nclass Meta:\n    model = Product\n    fields = ['name', 'price']\n    extra_kwargs = {\n        'name': {'lookups': ['icontains']},\n        'price': {'min_value': 0}\n    }\n</code></pre>"},{"location":"guide/filtering/fields/#add-validation","title":"Add Validation","text":"<pre><code># Validate early\nprice = IntegerField(min_value=0, max_value=1000000)\nsku = StringField(min_length=3, max_length=20, required=True)\n</code></pre>"},{"location":"guide/filtering/fields/#document-fields","title":"Document Fields","text":"<pre><code>class ProductFilterSet(FilterSet):\n    search = StringField(\n        method=\"filter_search\",\n        help_text=\"Search in name, description, and tags\"\n    )\n    min_price = IntegerField(\n        lookup_expr=\"price__gte\",\n        min_value=0,\n        help_text=\"Minimum price filter\"\n    )\n</code></pre>"},{"location":"guide/filtering/fields/#8-use-postgresql-features-when-available","title":"8. Use PostgreSQL Features When Available","text":"<pre><code># Use full-text search instead of icontains\nsearch = StringField(method=\"filter_fulltext\")\n\n# Use array fields for tags\ntags = ListField(child=StringField(), lookups=[\"pg_array\"])\n</code></pre>"},{"location":"guide/filtering/fields/#next-steps","title":"Next Steps","text":"<ul> <li>FilterSet - Complete FilterSet guide with custom methods, operators, preprocessors, postprocessors, and performance optimization</li> <li>Filtering Tutorial - Step-by-step tutorial covering all filtering concepts</li> </ul>"},{"location":"guide/filtering/filterset/","title":"FilterSet","text":"<p>Complete guide to FilterSet covering everything from basics to advanced usage, Meta options, ordering, fields overview, PostgreSQL features, and all important caveats.</p>"},{"location":"guide/filtering/filterset/#table-of-contents","title":"Table of Contents","text":"<ul> <li>What is FilterSet</li> <li>Creating FilterSets</li> <li>Meta Options</li> <li>Field Overview</li> <li>Using FilterSets</li> <li>Ordering</li> <li>Operators</li> <li>Preprocessors</li> <li>Postprocessors</li> <li>Validation</li> <li>PostgreSQL Features</li> <li>Important Caveats</li> <li>Best Practices</li> </ul>"},{"location":"guide/filtering/filterset/#what-is-filterset","title":"What is FilterSet","text":"<p>FilterSet is the core class in drf-restflow. It validates query parameters and applies filters to Django querysets using a declarative, type-safe syntax.</p> <pre><code>from restflow.filters import FilterSet\n\nclass ProductFilterSet(FilterSet):\n    name: str\n    price: int\n\n# Usage: ?name=laptop&amp;price=999\n</code></pre>"},{"location":"guide/filtering/filterset/#creating-filtersets","title":"Creating FilterSets","text":""},{"location":"guide/filtering/filterset/#type-annotations-simplest","title":"Type Annotations (Simplest)","text":"<pre><code>class ProductFilterSet(FilterSet):\n    name: str\n    price: int\n    in_stock: bool\n    created_at: datetime\n</code></pre>"},{"location":"guide/filtering/filterset/#explicit-field-declarations","title":"Explicit Field Declarations","text":"<pre><code>from restflow.filters import FilterSet, StringField, IntegerField\n\nclass ProductFilterSet(FilterSet):\n    name = StringField(lookups=[\"icontains\"])\n    price = IntegerField(lookups=[\"comparison\"], min_value=0)\n    category = IntegerField(lookup_expr=\"category__id\")\n</code></pre>"},{"location":"guide/filtering/filterset/#model-based-generation","title":"Model-Based Generation","text":"<pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        model = Product\n        fields = ['name', 'price', 'category']  # Specific fields\n        # or\n        fields = '__all__'  # All model fields\n</code></pre>"},{"location":"guide/filtering/filterset/#mixed-approach","title":"Mixed Approach","text":"<p>Combine custom fields with model-based generation:</p> <pre><code>class ProductFilterSet(FilterSet):\n    # Custom fields\n    search = StringField(method=\"filter_search\")\n    trending = BooleanField(method=\"filter_trending\")\n\n    # Model-based fields\n    class Meta:\n        model = Product\n        fields = ['category', 'in_stock', 'price']\n\n    def filter_search(self, filterset, queryset, value):\n        return Q(name__icontains=value) | Q(description__icontains=value)\n\n    def filter_trending(self, filterset, queryset, value):\n        if value:\n            week_ago = timezone.now() - timedelta(days=7)\n            return Q(created_at__gte=week_ago, views__gte=100)\n        return Q()\n</code></pre>"},{"location":"guide/filtering/filterset/#inlinefilterset-dynamic","title":"InlineFilterSet (Dynamic)","text":"<p>Create FilterSets dynamically without class definition:</p> <pre><code>from restflow.filters import InlineFilterSet\n\nProductFilterSet = InlineFilterSet(\n    model=Product,\n    fields=['name', 'price', 'category']\n)\n\n# Or with more options\nProductFilterSet = InlineFilterSet(\n    model=Product,\n    fields=['name', 'price'],\n    extra_kwargs={\n        'name': {'lookups': ['icontains']},\n        'price': {'min_value': 0}\n    }\n)\n</code></pre>"},{"location":"guide/filtering/filterset/#meta-options","title":"Meta Options","text":"<p>The <code>Meta</code> class configures FilterSet behavior. All options are optional.</p>"},{"location":"guide/filtering/filterset/#complete-meta-options-reference","title":"Complete Meta Options Reference","text":"<pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        # Model configuration\n        model = Product                    # Django model to generate fields from\n        fields = ['name', 'price']         # Fields to include ('__all__' for all)\n        exclude = ['internal_id']          # Fields to exclude\n\n        # Field configuration\n        extra_kwargs = {                   # Configure fields without explicit declaration\n            'name': {\n                'lookups': ['icontains', 'istartswith'],\n                'required': True,\n                'min_length': 2,\n                'help_text': 'Product name'\n            },\n            'price': {\n                'lookups': ['comparison'],\n                'min_value': 0,\n                'max_value': 1000000\n            }\n        }\n\n        # Operator\n        operator = \"AND\"                   # Combine filters with AND/OR/XOR (default: AND)\n\n        # Ordering\n        order_fields = [                   # Fields available for ordering\n            ('name', 'name'),              # (model_field, query_param)\n            ('price', 'price'),\n            ('created_at', 'created_at'),\n        ]\n        default_order_fields = [\"price\"]     # Default order field\n        order_param = \"order_by\"            # Order query parameter name\n        override_order_dir = \"asc\"          # Overrides an order direction, if set to \"desc\" then `-field` will be in ascending order \n        # Processors\n        preprocessors = [                  # Functions to run before filtering\n            exclude_deleted,\n            apply_permissions,\n        ]\n        postprocessors = [                 # Functions to run after filtering\n            apply_default_ordering,\n            ensure_distinct,\n        ]\n</code></pre>"},{"location":"guide/filtering/filterset/#model","title":"model","text":"<p>Specify the Django model to generate fields from:</p> <pre><code>class Meta:\n    model = Product\n</code></pre>"},{"location":"guide/filtering/filterset/#fields","title":"fields","text":"<p>Specify which fields to include:</p> <pre><code># Specific fields\nclass Meta:\n    model = Product\n    fields = ['name', 'price', 'category']\n\n# All fields\nclass Meta:\n    model = Product\n    fields = '__all__'\n\n# No fields (only custom fields)\nclass Meta:\n    model = Product\n    fields = []\n</code></pre>"},{"location":"guide/filtering/filterset/#exclude","title":"exclude","text":"<p>Exclude specific fields from generation:</p> <pre><code>class Meta:\n    model = Product\n    fields = '__all__'\n    exclude = ['internal_id', 'secret_key']\n</code></pre>"},{"location":"guide/filtering/filterset/#extra_kwargs","title":"extra_kwargs","text":"<p>Configure fields without explicit declarations:</p> <pre><code>class Meta:\n    model = Product\n    fields = ['name', 'price', 'category', 'status']\n    extra_kwargs = {\n        'name': {\n            'lookups': ['icontains', 'istartswith'],  # Add lookup variations\n            'required': True,                         # Make required\n            'min_length': 2,                          # Validation\n            'max_length': 200,\n            'help_text': 'Product name to search'\n        },\n        'price': {\n            'lookups': ['comparison'],                # Add gt, gte, lt, lte\n            'min_value': 0,                           # Must be &gt;= 0\n            'max_value': 1000000,                     # Must be &lt;= 1000000\n            'validators': [custom_validator]          # Custom validators\n        },\n        'category': {\n            'lookup_expr': 'category__id',            # Custom lookup expression\n            'required': False\n        },\n        'status': {\n            'choices': [                              # Limit to choices\n                ('draft', 'Draft'),\n                ('published', 'Published')\n            ]\n        }\n    }\n</code></pre> <p>extra_kwargs options: - <code>lookups</code>: List of lookup expressions to generate - <code>lookup_expr</code>: Custom lookup expression - <code>required</code>: Make field required - <code>min_value</code>, <code>max_value</code>: Numeric validation - <code>min_length</code>, <code>max_length</code>: String validation - <code>validators</code>: List of custom validators - <code>choices</code>: Limit to specific choices - <code>help_text</code>: Description for API documentation - <code>method</code>: Custom filter method name - Any other DRF field parameter</p>"},{"location":"guide/filtering/filterset/#operator","title":"operator","text":"<p>Control how filters are combined (default: <code>\"AND\"</code>):</p> <pre><code># All filters must match (default)\nclass Meta:\n    operator = \"AND\"\n\n# Any filter can match\nclass Meta:\n    operator = \"OR\"\n\n# Exactly one filter must match\nclass Meta:\n    operator = \"XOR\"\n</code></pre> <p>See Operators section for details.</p>"},{"location":"guide/filtering/filterset/#order_fields","title":"order_fields","text":"<p>Define which fields can be used for ordering:</p> <pre><code>class Meta:\n    order_param = \"sort_by\"    # Query param responsible for ordering \n    order_fields = [\n        ('name', 'name'),               # Can order by:`?sort_by=name` or `?sort_by=-name`\n        ('price', 'price'),\n        ('created_at', 'created_at'),\n        ('review_count', 'reviews'),   # Annotated field\n    ]\n\n    default_order_fields = [\"price\"]  # If the value is empty, the queryset will be ordered by price\n    order_field_labels = [(\"Item Name\", \"name\")]  # For schema generation / viewing\n    override_order_dir = \"desc\"  # This will reverse the ordering, queryset.order_by(\"-price\"), will order by price in ascending order\n                                # and .order_by(\"price\") will sort by price in descending order\n</code></pre> <p>See Ordering section for details.</p>"},{"location":"guide/filtering/filterset/#preprocessors","title":"preprocessors","text":"<p>Functions that run before filters are applied:</p> <pre><code>def exclude_deleted(filterset, queryset):\n    return queryset.filter(deleted_at__isnull=True)\n\nclass Meta:\n    preprocessors = [exclude_deleted]\n</code></pre> <p>See Preprocessors section for details.</p>"},{"location":"guide/filtering/filterset/#postprocessors","title":"postprocessors","text":"<p>Functions that run after filters are applied:</p> <pre><code>def apply_default_ordering(filterset, queryset):\n    if not queryset.ordered:\n        return queryset.order_by('-created_at')\n    return queryset\n\nclass Meta:\n    postprocessors = [apply_default_ordering]\n</code></pre> <p>See Postprocessors section for details.</p>"},{"location":"guide/filtering/filterset/#field-overview","title":"Field Overview","text":"<p>FilterSet supports various field types. See Fields for complete details.</p>"},{"location":"guide/filtering/filterset/#available-field-types","title":"Available Field Types","text":"<pre><code>from restflow.filters import (\n    # Basic types\n    StringField, IntegerField, FloatField, BooleanField, DecimalField,\n\n    # Date/Time\n    DateField, DateTimeField, TimeField,\n\n    # Choices\n    ChoiceField, MultipleChoiceField,\n\n    # Lists\n    ListField,\n\n    # Special\n    OrderField,\n)\n</code></pre>"},{"location":"guide/filtering/filterset/#type-annotations","title":"Type Annotations","text":"<p>Use Python type annotations for automatic field generation:</p> <pre><code>from typing import List, Literal\nfrom datetime import datetime\n\nclass ProductFilterSet(FilterSet):\n    # Basic types\n    name: str                                    # StringField\n    price: int                                   # IntegerField\n    rating: float                                # FloatField\n    in_stock: bool                               # BooleanField\n\n    # Date/Time\n    created_at: datetime                         # DateTimeField\n\n    # Choices with Literal\n    status: Literal[\"draft\", \"published\"]        # ChoiceField\n\n    # Lists\n    tags: List[int]                              # ListField with IntegerField child\n    categories: List[str]                        # ListField with StringField child\n</code></pre>"},{"location":"guide/filtering/filterset/#lookups","title":"Lookups","text":"<p>Fields can have lookup variations:</p> <pre><code>class ProductFilterSet(FilterSet):\n    # Single lookup\n    name = StringField(lookups=[\"icontains\"])\n    # Creates: name__icontains\n\n    # Multiple lookups\n    price = IntegerField(lookups=[\"gte\", \"lte\"])\n    # Creates: price__gte, price__lte\n\n    # Lookup categories\n    title = StringField(lookups=[\"text\"])\n    # Creates: title__icontains, title__contains, title__startswith,\n    #          title__endswith, title__iexact\n\n    # Comparison category\n    views = IntegerField(lookups=[\"comparison\"])\n    # Creates: views__gt, views__gte, views__lt, views__lte\n</code></pre>"},{"location":"guide/filtering/filterset/#custom-lookup-expressions","title":"Custom Lookup Expressions","text":"<pre><code>class ProductFilterSet(FilterSet):\n    # Filter by related field\n    category_name = StringField(lookup_expr=\"category__name__icontains\")\n\n    # Nested relationships\n    department = StringField(lookup_expr=\"category__department__name\")\n\n    # Multiple levels\n    region = StringField(lookup_expr=\"store__address__city__region__name\")\n</code></pre>"},{"location":"guide/filtering/filterset/#negation","title":"Negation","text":"<p>All filters automatically support negation with <code>!</code>:</p> <pre><code># No configuration needed - automatic!\n\n# ?status!=draft              # NOT draft\n# ?price__gte!=1000          # NOT &gt;= 1000\n# ?name__icontains!=test     # NOT containing test\n</code></pre>"},{"location":"guide/filtering/filterset/#using-filtersets","title":"Using FilterSets","text":""},{"location":"guide/filtering/filterset/#in-views","title":"In Views","text":"<pre><code>from rest_framework import generics\nfrom rest_framework.exceptions import ValidationError\n\nclass ProductListView(generics.ListAPIView):\n    serializer_class = ProductSerializer\n\n    def get_queryset(self):\n        queryset = Product.objects.all()\n        filterset = ProductFilterSet(request=self.request)\n\n        if not filterset.is_valid():\n            raise ValidationError(filterset.errors)\n\n        return filterset.filter_queryset(queryset)\n</code></pre>"},{"location":"guide/filtering/filterset/#filter_queryset-method","title":"filter_queryset() Method","text":"<p>The <code>filter_queryset()</code> method applies all filters to a queryset:</p> <pre><code>filterset = ProductFilterSet(request=request)\nfiltered_qs = filterset.filter_queryset(Product.objects.all())\n</code></pre> <p>With ignore parameter:</p> <p>Skip specific filters when applying:</p> <pre><code># Ignore certain filters\nfiltered_qs = filterset.filter_queryset(\n    Product.objects.all(),\n    ignore=['search', 'trending']\n)\n\n# Useful when you want to apply some filters manually\n# or conditionally skip certain filters\n</code></pre> <p>Example use case:</p> <pre><code>class ProductListView(generics.ListAPIView):\n    def get_queryset(self):\n        queryset = Product.objects.all()\n        filterset = ProductFilterSet(request=self.request)\n\n        # Apply all filters except 'search'\n        # We'll handle search separately\n        queryset = filterset.filter_queryset(queryset, ignore=['search'])\n\n        # Custom search logic with highlighting\n        if 'search' in filterset.data:\n            search_term = filterset.data['search']\n            queryset = self.apply_custom_search(queryset, search_term)\n\n        return queryset\n</code></pre>"},{"location":"guide/filtering/filterset/#from-dictionary","title":"From Dictionary","text":"<pre><code>data = {'name__icontains': 'laptop', 'price__gte': 100}\nfilterset = ProductFilterSet(data=data)\n</code></pre>"},{"location":"guide/filtering/filterset/#accessing-data","title":"Accessing Data","text":"<pre><code>filterset = ProductFilterSet(request=request)\n\n# Check if valid\nif filterset.is_valid():\n    # Get validated data\n    data = filterset.validated_data\n    # {'name': 'laptop', 'price__gte': 100}\nelse:\n    # Get errors\n    errors = filterset.errors\n    # {'price': ['A valid integer is required.']}\n\n# Get as dictionary\n# Automatically does `.is_valid()`\ndata = filterset.model_dump()\n</code></pre>"},{"location":"guide/filtering/filterset/#ordering","title":"Ordering","text":"<p>Add ordering/sorting to your FilterSet.</p>"},{"location":"guide/filtering/filterset/#using-metaorder_fields","title":"Using Meta.order_fields","text":"<pre><code>class ProductFilterSet(FilterSet):\n    name: str\n    price: int\n\n    class Meta:\n        # If the value is empty, the queryset will be ordered by price\n        order_param = \"sort_by\"    # Query param responsible for ordering, by default set to 'order_by'\n        order_fields = [\n            ('name', 'name'),               # Can order by:`?sort_by=name` or `?sort_by=-name`\n            ('price', 'price'),\n            ('created_at', 'created_at'),\n            ('review_count', 'reviews'),   # Annotated field\n        ]\n\n        default_order_fields = [\"price\"]  \n        order_field_labels = [(\"Item Name\", \"name\")]  # For schema generation / viewing\n        override_order_dir = \"asc\"  \n\n# Usage:\n# ?sort_by=name          # Ascending\n# ?sort_by=-name         # Descending\n# ?sort_by=price         # By price ascending\n# ?sort_by=-created_at   # Newest first\n</code></pre>"},{"location":"guide/filtering/filterset/#overriding-order-direction","title":"Overriding order direction.","text":"<pre><code>class ProductFilterSet(FilterSet):\n    name: str\n    price: int\n\n    class Meta:\n        order_fields = [\n            ('name', 'name'),               # Can order by:`?sort_by=name` or `?sort_by=-name`\n            ('price', 'price'),\n            ('created_at', 'created_at'),\n            ('review_count', 'reviews'),   # Annotated field\n        ]\n        override_order_dir = \"desc\"  \n\n# Usage:\n# ?order_by=name          # Descending\n# ?order_by=-name         # Ascending\n# ?order_by=price         # By price descending\n# ?order_by=-created_at   # Oldest first\n</code></pre>"},{"location":"guide/filtering/filterset/#ordering-by-annotated-fields","title":"Ordering by Annotated Fields","text":"<pre><code>from django.db.models import Count\n\ndef add_annotations(filterset, queryset):\n    return queryset.annotate(\n        review_count=Count('reviews')\n    )\n\nclass ProductFilterSet(FilterSet):\n    class Meta:\n        preprocessors = [add_annotations]\n        order_fields = [\n            ('name', 'name'),\n            ('review_count', 'reviews'),  # Order by annotation\n        ]\n\n# Usage:\n# ?order_by=reviews       # Least reviews first\n# ?order_by=-reviews      # Most reviews first\n</code></pre>"},{"location":"guide/filtering/filterset/#using-orderfield-explicitly","title":"Using OrderField Explicitly","text":"<pre><code>from restflow.filters import OrderField\n\nclass ProductFilterSet(FilterSet):\n    ordering = OrderField(\n        fields=[\n            ('name', 'name'),\n            ('price', 'price'),\n            ('created_at', 'created_at'),\n        ]\n    )\n\n# Usage same as Meta.order_fields\n# ?ordering=name\n# ?ordering=-price\n</code></pre>"},{"location":"guide/filtering/filterset/#default-ordering-with-postprocessor","title":"Default Ordering with Postprocessor","text":"<pre><code>class ProductFilterSet(FilterSet):\n    class Meta:\n        default_order_fields = [\"price\"]\n        order_fields = [('name', 'name'), ('created_at', 'created_at')]\n        postprocessors = [apply_default_ordering]\n\n# Queries without ?order_by get default ordering by price\n</code></pre>"},{"location":"guide/filtering/filterset/#operators","title":"Operators","text":"<p>Operators control how multiple filters are combined.</p>"},{"location":"guide/filtering/filterset/#and-operator-default","title":"AND Operator (Default)","text":"<p>All conditions must match:</p> <pre><code>class ProductFilterSet(FilterSet):\n    name: str\n    category: str\n\n    class Meta:\n        operator = \"AND\"  # Default\n\n# ?name=laptop&amp;category=electronics\n# SQL: WHERE name='laptop' AND category='electronics'\n</code></pre>"},{"location":"guide/filtering/filterset/#or-operator","title":"OR Operator","text":"<p>Any condition can match:</p> <pre><code>class ProductFilterSet(FilterSet):\n    name: str\n    description: str\n\n    class Meta:\n        operator = \"OR\"\n\n# ?name__icontains=wireless&amp;description__icontains=bluetooth\n# SQL: WHERE name ILIKE '%wireless%' OR description ILIKE '%bluetooth%'\n</code></pre>"},{"location":"guide/filtering/filterset/#xor-operator","title":"XOR Operator","text":"<p>Exactly one condition must match:</p> <pre><code>class ProductFilterSet(FilterSet):\n    is_new: bool\n    is_refurbished: bool\n\n    class Meta:\n        operator = \"XOR\"\n\n# ?is_new=true&amp;is_refurbished=true\n# Returns items that are EITHER new OR refurbished (not both)\n</code></pre>"},{"location":"guide/filtering/filterset/#operator-with-custom-methods","title":"Operator with Custom Methods","text":"<p>\u26a0\ufe0f CRITICAL CAVEAT: Operators only work correctly when custom methods return Q objects:</p> <pre><code>class ProductFilterSet(FilterSet):\n    in_stock = BooleanField(method=\"filter_in_stock\")\n    category: str\n\n    class Meta:\n        operator = \"OR\"\n\n    # \u2705 CORRECT - Returns Q object\n    def filter_in_stock(self, filterset, queryset, value):\n        if value:\n            return Q(inventory__gt=0)\n        return Q()\n\n    # \u274c WRONG - Returns QuerySet (operator ignored!)\n    def filter_in_stock_wrong(self, filterset, queryset, value):\n        if value:\n            return queryset.filter(inventory__gt=0)\n        return queryset\n</code></pre> <p>See Custom Method Caveat for details.</p>"},{"location":"guide/filtering/filterset/#preprocessors_1","title":"Preprocessors","text":"<p>Preprocessors transform querysets before filters are applied.</p>"},{"location":"guide/filtering/filterset/#basic-usage","title":"Basic Usage","text":"<pre><code>def exclude_deleted(filterset, queryset):\n    \"\"\"Always exclude soft-deleted items\"\"\"\n    return queryset.filter(deleted_at__isnull=True)\n\nclass ProductFilterSet(FilterSet):\n    name: str\n\n    class Meta:\n        preprocessors = [exclude_deleted]\n</code></pre>"},{"location":"guide/filtering/filterset/#multiple-preprocessors","title":"Multiple Preprocessors","text":"<p>Run in order declared:</p> <pre><code>def exclude_deleted(filterset, queryset):\n    return queryset.filter(deleted_at__isnull=True)\n\ndef apply_permissions(filterset, queryset):\n    if filterset.request and not filterset.request.user.is_staff:\n        return queryset.filter(status='published')\n    return queryset\n\ndef optimize_queries(filterset, queryset):\n    return queryset.select_related('category').prefetch_related('tags')\n\nclass ProductFilterSet(FilterSet):\n    class Meta:\n        preprocessors = [\n            exclude_deleted,      # 1. Filter deleted\n            apply_permissions,    # 2. Apply permissions\n            optimize_queries,     # 3. Optimize\n        ]\n</code></pre>"},{"location":"guide/filtering/filterset/#adding-annotations","title":"Adding Annotations","text":"<pre><code>from django.db.models import Count, Avg\n\ndef add_review_stats(filterset, queryset):\n    return queryset.annotate(\n        review_count=Count('reviews'),\n        avg_rating=Avg('reviews__rating')\n    )\n\nclass ProductFilterSet(FilterSet):\n    min_reviews = IntegerField(method=\"filter_min_reviews\")\n    min_rating = FloatField(method=\"filter_min_rating\")\n\n    class Meta:\n        preprocessors = [add_review_stats]\n\n    def filter_min_reviews(self, filterset, queryset, value):\n        return Q(review_count__gte=value)\n\n    def filter_min_rating(self, filterset, queryset, value):\n        return Q(avg_rating__gte=value)\n</code></pre>"},{"location":"guide/filtering/filterset/#request-based-filtering","title":"Request-Based Filtering","text":"<pre><code>def tenant_isolation(filterset, queryset):\n    \"\"\"Multi-tenant data isolation\"\"\"\n    if not filterset.request or not filterset.request.user.is_authenticated:\n        return queryset.none()\n\n    tenant = filterset.request.user.tenant\n    return queryset.filter(tenant=tenant)\n\nclass ProductFilterSet(FilterSet):\n    class Meta:\n        preprocessors = [tenant_isolation]\n</code></pre>"},{"location":"guide/filtering/filterset/#conditional-optimization","title":"Conditional Optimization","text":"<pre><code>def smart_optimization(filterset, queryset):\n    \"\"\"Only optimize what's needed\"\"\"\n    # Always select related ForeignKeys\n    queryset = queryset.select_related('category', 'brand')\n\n    # Conditionally prefetch M2M\n    if 'tags' in filterset.data:\n        queryset = queryset.prefetch_related('tags')\n\n    if 'reviews' in filterset.request.query_params:\n        queryset = queryset.prefetch_related('reviews')\n\n    return queryset\n\nclass ProductFilterSet(FilterSet):\n    class Meta:\n        preprocessors = [smart_optimization]\n</code></pre>"},{"location":"guide/filtering/filterset/#postprocessors_1","title":"Postprocessors","text":"<p>Postprocessors transform querysets after filters are applied.</p>"},{"location":"guide/filtering/filterset/#basic-usage_1","title":"Basic Usage","text":"<pre><code>def apply_default_ordering(filterset, queryset):\n    if not queryset.ordered:\n        return queryset.order_by('-created_at')\n    return queryset\n\nclass ProductFilterSet(FilterSet):\n    class Meta:\n        postprocessors = [apply_default_ordering]\n</code></pre>"},{"location":"guide/filtering/filterset/#ensure-distinct","title":"Ensure Distinct","text":"<pre><code>def ensure_distinct(filterset, queryset):\n    \"\"\"Remove duplicates from M2M filtering\"\"\"\n    return queryset.distinct()\n\nclass ProductFilterSet(FilterSet):\n    tags: List[int]\n\n    class Meta:\n        postprocessors = [ensure_distinct]\n</code></pre>"},{"location":"guide/filtering/filterset/#audit-logging","title":"Audit Logging","text":"<pre><code>import logging\nlogger = logging.getLogger(__name__)\n\ndef log_filter_usage(filterset, queryset):\n    if filterset.request:\n        user = getattr(filterset.request.user, 'username', 'anonymous')\n        filters = dict(filterset.data)\n        logger.info(f\"User {user} filtered: {filters}\")\n    return queryset\n\nclass ProductFilterSet(FilterSet):\n    class Meta:\n        postprocessors = [log_filter_usage]\n</code></pre>"},{"location":"guide/filtering/filterset/#performance-monitoring","title":"Performance Monitoring","text":"<pre><code>import time\nimport logging\nlogger = logging.getLogger(__name__)\n\ndef monitor_performance(filterset, queryset):\n    start = time.time()\n    count = queryset.count()\n    duration = time.time() - start\n\n    if duration &gt; 1.0:\n        logger.warning(\n            f\"Slow query: {duration:.2f}s for {count} results. \"\n            f\"Filters: {dict(filterset.data)}\"\n        )\n    return queryset\n\nclass ProductFilterSet(FilterSet):\n    class Meta:\n        postprocessors = [monitor_performance]\n</code></pre>"},{"location":"guide/filtering/filterset/#validation","title":"Validation","text":""},{"location":"guide/filtering/filterset/#automatic-validation","title":"Automatic Validation","text":"<p>FilterSet uses DRF serializers for automatic type validation:</p> <pre><code>class ProductFilterSet(FilterSet):\n    price: int  # Only accepts integers\n\n# ?price=abc \u2192 {\"price\": [\"A valid integer is required.\"]}\n</code></pre>"},{"location":"guide/filtering/filterset/#field-level-validation","title":"Field-Level Validation","text":"<pre><code>from rest_framework.validators import MinValueValidator\n\nclass ProductFilterSet(FilterSet):\n    price = IntegerField(\n        min_value=0,\n        max_value=1_000_000,\n        validators=[MinValueValidator(0)]\n    )\n\n# ?price=-10 \u2192 {\"price\": [\"Ensure this value is greater than or equal to 0.\"]}\n</code></pre>"},{"location":"guide/filtering/filterset/#filterset-level-validation","title":"FilterSet-Level Validation","text":"<pre><code>from rest_framework.exceptions import ValidationError\n\nclass ProductFilterSet(FilterSet):\n    min_price = IntegerField(lookup_expr=\"price__gte\")\n    max_price = IntegerField(lookup_expr=\"price__lte\")\n\n    def validate(self, data):\n        if 'min_price' in data and 'max_price' in data:\n            if data['min_price'] &gt; data['max_price']:\n                raise ValidationError({\n                    'max_price': 'Must be greater than min_price'\n                })\n        return data\n\n# ?min_price=1000&amp;max_price=500 \u2192 400 Bad Request\n</code></pre>"},{"location":"guide/filtering/filterset/#custom-validators","title":"Custom Validators","text":"<pre><code>from rest_framework.exceptions import ValidationError\n\ndef validate_even(value):\n    if value % 2 != 0:\n        raise ValidationError(\"Must be an even number\")\n\nclass ProductFilterSet(FilterSet):\n    batch_size = IntegerField(validators=[validate_even])\n</code></pre>"},{"location":"guide/filtering/filterset/#postgresql-features","title":"PostgreSQL Features","text":"<p>drf-restflow supports PostgreSQL-specific features. See Fields for complete PostgreSQL field details.</p>"},{"location":"guide/filtering/filterset/#full-text-search","title":"Full-Text Search","text":"<pre><code>from django.contrib.postgres.search import SearchVector, SearchQuery, SearchRank\n\nclass ProductFilterSet(FilterSet):\n    search = StringField(method=\"filter_fulltext_search\")\n\n    def filter_fulltext_search(self, filterset, queryset, value):\n        vector = SearchVector('name', weight='A') + SearchVector('description', weight='B')\n        query = SearchQuery(value)\n        return queryset.annotate(\n            search=vector,\n            rank=SearchRank(vector, query)\n        ).filter(search=query).order_by('-rank')\n\n# ?search=wireless headphones\n# Uses PostgreSQL full-text search with ranking\n</code></pre>"},{"location":"guide/filtering/filterset/#array-fields","title":"Array Fields","text":"<pre><code>from django.contrib.postgres.fields import ArrayField\n\nclass Product(models.Model):\n    tags = ArrayField(models.CharField(max_length=50))\n\nclass ProductFilterSet(FilterSet):\n    tags = ListField(\n        child=StringField(),\n        lookups=[\"pg_array\"]  # PostgreSQL array lookups\n    )\n\n# ?tags__contains=wireless       # Array contains value\n# ?tags__overlap=wireless,bluetooth  # Array overlaps with values\n# ?tags__contained_by=a,b,c     # Array contained by values\n</code></pre>"},{"location":"guide/filtering/filterset/#json-fields","title":"JSON Fields","text":"<pre><code>from django.db import models\n\nclass Product(models.Model):\n    metadata = models.JSONField()\n\nclass ProductFilterSet(FilterSet):\n    # Filter by JSON key\n    brand = StringField(lookup_expr=\"metadata__brand\")\n    color = StringField(lookup_expr=\"metadata__specs__color\")\n\n# ?brand=Apple\n# ?color=red\n</code></pre>"},{"location":"guide/filtering/filterset/#using-searchvector-in-preprocessor","title":"Using SearchVector in Preprocessor","text":"<pre><code>from django.contrib.postgres.search import SearchVector\n\ndef add_search_vector(filterset, queryset):\n    \"\"\"Add search vector for better full-text search\"\"\"\n    if 'search' in filterset.data:\n        return queryset.annotate(\n            search_vector=SearchVector('name', 'description', 'tags')\n        )\n    return queryset\n\nclass ProductFilterSet(FilterSet):\n    search = StringField(method=\"filter_search\")\n\n    class Meta:\n        preprocessors = [add_search_vector]\n\n    def filter_search(self, filterset, queryset, value):\n        from django.contrib.postgres.search import SearchQuery\n        return queryset.filter(search_vector=SearchQuery(value))\n</code></pre>"},{"location":"guide/filtering/filterset/#important-caveats","title":"Important Caveats","text":""},{"location":"guide/filtering/filterset/#custom-method-caveat","title":"Custom Method Caveat","text":"<p>\u26a0\ufe0f CRITICAL: When custom methods return QuerySet instead of Q objects, the FilterSet operator is NOT applied.</p> <pre><code>class ProductFilterSet(FilterSet):\n    in_stock = BooleanField(method=\"filter_in_stock\")\n    category: str\n\n    class Meta:\n        operator = \"OR\"  # \u26a0\ufe0f Won't apply to QuerySet returns!\n\n    # \u274c WRONG - Returns QuerySet\n    def filter_in_stock(self, filterset, queryset, value):\n        if value:\n            return queryset.filter(inventory__gt=0)\n        return queryset\n\n# Query: ?in_stock=true&amp;category=electronics\n# Expected (OR): in_stock=true OR category=electronics\n# Actual: in_stock=true AND category=electronics  (Operator ignored!)\n</code></pre> <p>\u2705 SOLUTION: Always return Q objects:</p> <pre><code>def filter_in_stock(self, filterset, queryset, value):\n    if value:\n        return Q(inventory__gt=0)\n    return Q()  # Empty Q matches everything\n</code></pre> <p>Why Q objects? - Work correctly with ALL operators (AND, OR, XOR) - Properly combined with other filters - More predictable behavior - Better for complex queries</p>"},{"location":"guide/filtering/filterset/#annotation-performance","title":"Annotation Performance","text":"<p>\u274c Don't annotate in each filter method:</p> <pre><code>def filter_min_reviews(self, filterset, queryset, value):\n    # Bad - annotation repeated for each call\n    return queryset.annotate(count=Count('reviews')).filter(count__gte=value)\n</code></pre> <p>\u2705 Annotate once in preprocessor:</p> <pre><code>def add_annotations(filterset, queryset):\n    return queryset.annotate(review_count=Count('reviews'))\n\nclass Meta:\n    preprocessors = [add_annotations]\n\ndef filter_min_reviews(self, filterset, queryset, value):\n    return Q(review_count__gte=value)\n</code></pre>"},{"location":"guide/filtering/filterset/#request-access","title":"Request Access","text":"<p>Always check if request exists:</p> <pre><code>def user_filter(filterset, queryset):\n    # \u2705 Check request exists\n    if not filterset.request:\n        return queryset\n\n    if not filterset.request.user.is_authenticated:\n        return queryset.filter(is_public=True)\n\n    return queryset\n</code></pre>"},{"location":"guide/filtering/filterset/#processor-return-values","title":"Processor Return Values","text":"<p>Always return queryset:</p> <pre><code># \u2705 Good\ndef my_processor(filterset, queryset):\n    return queryset.filter(active=True)\n\n# \u274c Bad - returns None\ndef my_processor(filterset, queryset):\n    queryset.filter(active=True)  # Missing return!\n</code></pre>"},{"location":"guide/filtering/filterset/#best-practices","title":"Best Practices","text":""},{"location":"guide/filtering/filterset/#always-return-q-objects-from-custom-methods","title":"Always Return Q Objects from Custom Methods","text":"<pre><code># \u2705 Always prefer Q objects\ndef filter_method(self, filterset, queryset, value):\n    return Q(field=value)\n\n# \u274c Avoid QuerySet returns (unless using AND operator, or you really need to)\ndef filter_method(self, filterset, queryset, value):\n    return queryset.filter(field=value)\n</code></pre>"},{"location":"guide/filtering/filterset/#use-extra_kwargs-for-simple-configuration","title":"Use extra_kwargs for Simple Configuration","text":"<pre><code># \u2705 Clean and maintainable\nclass Meta:\n    model = Product\n    fields = ['name', 'price']\n    extra_kwargs = {\n        'name': {'lookups': ['icontains']},\n        'price': {'min_value': 0}\n    }\n\n# \u274c More verbose\nname = StringField(lookups=['icontains'])\nprice = IntegerField(min_value=0)\n</code></pre>"},{"location":"guide/filtering/filterset/#keep-processors-simple","title":"Keep Processors Simple","text":"<pre><code># \u2705 Single responsibility principle\ndef exclude_deleted(filterset, queryset):\n    return queryset.filter(deleted_at__isnull=True)\n\n# \u274c Too many responsibilities\ndef do_everything(filterset, queryset):\n    queryset = queryset.filter(deleted_at__isnull=True)\n    queryset = queryset.select_related('category')\n    queryset = queryset.annotate(count=Count('items'))\n    return queryset\n</code></pre>"},{"location":"guide/filtering/filterset/#processor-order-matters","title":"Processor Order Matters","text":"<pre><code>class Meta:\n    preprocessors = [\n        exclude_deleted,      # 1. Filter first\n        apply_permissions,    # 2. Then permissions\n        add_annotations,      # 3. Add annotations\n        optimize_queries,     # 4. Finally optimize\n    ]\n</code></pre>"},{"location":"guide/filtering/filterset/#use-ignore-parameter-wisely","title":"Use ignore Parameter Wisely","text":"<pre><code># Useful for custom handling of specific filters\nfiltered_qs = filterset.filter_queryset(\n    queryset,\n    ignore=['search']  # Handle search separately with highlighting\n)\n</code></pre>"},{"location":"guide/filtering/filterset/#next-steps","title":"Next Steps","text":"<ul> <li>Fields - Complete guide to all field types, lookups, validation, and PostgreSQL features</li> <li>Filtering Tutorial - Step-by-step tutorial with practical examples</li> </ul>"},{"location":"tutorial/filtering/","title":"Tutorial: Filtering","text":"<p>A comprehensive step-by-step tutorial covering everything about filtering with drf-restflow, from basic concepts to production-ready implementations.</p>"},{"location":"tutorial/filtering/#topics","title":"Topics","text":"<ul> <li>Creating FilterSets with type annotations and explicit fields</li> <li>Using lookups and operators</li> <li>Writing custom filter methods with Q objects</li> <li>Filtering across relationships</li> <li>Validation and ordering</li> <li>Performance optimization for production</li> </ul>"},{"location":"tutorial/filtering/#prerequisites","title":"Prerequisites","text":"<ul> <li>Django project set up</li> </ul>"},{"location":"tutorial/filtering/#setup","title":"Setup","text":"<p>Create a new Django app for this tutorial:</p> <pre><code>python manage.py startapp articles\n</code></pre> <p>Add to <code>INSTALLED_APPS</code>:</p> <pre><code># settings.py\nINSTALLED_APPS = [\n    # ...\n    'rest_framework',\n    'articles',\n]\n</code></pre>"},{"location":"tutorial/filtering/#part-1-basic-filtering","title":"Part 1: Basic Filtering","text":""},{"location":"tutorial/filtering/#create-models","title":"Create Models","text":"<pre><code># articles/models.py\nfrom django.db import models\nfrom django.contrib.auth.models import User\n\nclass Category(models.Model):\n    name = models.CharField(max_length=100)\n    slug = models.SlugField(unique=True)\n\n    def __str__(self):\n        return self.name\n\nclass Tag(models.Model):\n    name = models.CharField(max_length=50)\n    slug = models.SlugField(unique=True)\n\n    def __str__(self):\n        return self.name\n\nclass Article(models.Model):\n    STATUS_CHOICES = [\n        ('draft', 'Draft'),\n        ('published', 'Published'),\n    ]\n\n    title = models.CharField(max_length=200)\n    content = models.TextField()\n    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='draft')\n    views = models.IntegerField(default=0)\n    is_featured = models.BooleanField(default=False)\n\n    author = models.ForeignKey(User, on_delete=models.CASCADE, related_name='articles')\n    category = models.ForeignKey(Category, on_delete=models.SET_NULL, null=True, related_name='articles')\n    tags = models.ManyToManyField(Tag, related_name='articles', blank=True)\n\n    published_at = models.DateTimeField(null=True, blank=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n\n    class Meta:\n        ordering = ['-created_at']\n\n    def __str__(self):\n        return self.title\n</code></pre> <p>Run migrations:</p> <pre><code>python manage.py makemigrations\npython manage.py migrate\n</code></pre>"},{"location":"tutorial/filtering/#your-first-filterset","title":"Your First FilterSet","text":"<p>Create a simple FilterSet with type annotations:</p> <pre><code># articles/filters.py\nfrom restflow.filters import FilterSet\n\nclass ArticleFilterSet(FilterSet):\n    # Type annotations create exact match filters\n    title: str\n    status: str\n\n# This creates filters for:\n# - title (exact match)\n# - status (exact match)\n</code></pre>"},{"location":"tutorial/filtering/#create-serializer-and-view","title":"Create Serializer and View","text":"<pre><code># articles/serializers.py\nfrom rest_framework import serializers\nfrom .models import Article\n\nclass ArticleSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Article\n        fields = ['id', 'title', 'content', 'status', 'views', 'created_at']\n</code></pre> <pre><code># articles/views.py\nfrom rest_framework import generics\nfrom rest_framework.exceptions import ValidationError\nfrom .models import Article\nfrom .serializers import ArticleSerializer\nfrom .filters import ArticleFilterSet\n\nclass ArticleListView(generics.ListAPIView):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n\n    def get_queryset(self):\n        queryset = super().get_queryset()\n        filterset = ArticleFilterSet(request=self.request)\n        return filterset.filter_queryset(queryset)\n</code></pre>"},{"location":"tutorial/filtering/#configure-urls","title":"Configure URLs","text":"<pre><code># articles/urls.py\nfrom django.urls import path\nfrom .views import ArticleListView\n\nurlpatterns = [\n    path('articles/', ArticleListView.as_view(), name='article-list'),\n]\n</code></pre> <pre><code># project/urls.py\nfrom django.urls import path, include\n\nurlpatterns = [\n    # ...\n    path('api/', include('articles.urls')),\n]\n</code></pre>"},{"location":"tutorial/filtering/#test-it","title":"Test It","text":"<pre><code>python manage.py runserver\n\n# Create some test data in shell:\npython manage.py shell\n&gt;&gt;&gt; from articles.models import Article\n&gt;&gt;&gt; from django.contrib.auth.models import User\n&gt;&gt;&gt; user = User.objects.create_user('testuser')\n&gt;&gt;&gt; Article.objects.create(title=\"First Article\", content=\"Content\", status=\"published\", author=user)\n&gt;&gt;&gt; Article.objects.create(title=\"Second Article\", content=\"Content\", status=\"draft\", author=user)\n</code></pre> <p>Test the API:</p> <pre><code>curl http://localhost:8000/api/articles/\ncurl http://localhost:8000/api/articles/?status=published\ncurl http://localhost:8000/api/articles/?title=First%20Article\n</code></pre>"},{"location":"tutorial/filtering/#lookups-and-operators","title":"Lookups and Operators","text":""},{"location":"tutorial/filtering/#adding-lookups","title":"Adding Lookups","text":"<p>Lookups allow flexible filtering beyond exact matches:</p> <pre><code># articles/filters.py\nfrom restflow.filters import FilterSet, StringField, IntegerField, DateTimeField\n\nclass ArticleFilterSet(FilterSet):\n    # Text lookups\n    title = StringField(lookups=[\"icontains\", \"istartswith\"])\n    # Creates: title__icontains, title__istartswith\n\n    # Numeric comparisons\n    views = IntegerField(lookups=[\"comparison\"])\n    # Creates: views__gt, views__gte, views__lt, views__lte\n\n    # Date comparisons\n    published_at = DateTimeField(lookups=[\"comparison\"])\n\n    # Simple fields\n    status: str\n</code></pre> <p>Test it:</p> <pre><code># Search titles containing \"article\"\ncurl \"http://localhost:8000/api/articles/?title__icontains=article\"\n\n# Articles with more than 100 views\ncurl \"http://localhost:8000/api/articles/?views__gt=100\"\n\n# Articles published after a date\ncurl \"http://localhost:8000/api/articles/?published_at__gte=2024-01-01T00:00:00Z\"\n</code></pre>"},{"location":"tutorial/filtering/#lookup-categories","title":"Lookup Categories","text":"<p>Instead of listing individual lookups, use categories:</p> <pre><code>class ArticleFilterSet(FilterSet):\n    # \"text\" category: icontains, contains, startswith, endswith, iexact\n    title = StringField(lookups=[\"text\"])\n\n    # \"comparison\" category: gt, gte, lt, lte\n    views = IntegerField(lookups=[\"comparison\"])\n    published_at = DateTimeField(lookups=[\"comparison\"])\n\n    status: str\n</code></pre>"},{"location":"tutorial/filtering/#automatic-negation","title":"Automatic Negation","text":"<p>All filters automatically support negation with <code>!</code>:</p> <pre><code># No configuration needed!\n\n# ?status!=draft              # NOT draft\n# ?views__gte!=1000          # NOT &gt;= 1000\n# ?title__icontains!=test    # NOT containing \"test\"\n</code></pre>"},{"location":"tutorial/filtering/#operators","title":"Operators","text":"<p>Operators control how multiple filters are combined.</p> <p>AND (default) - All filters must match:</p> <pre><code>class ArticleFilterSet(FilterSet):\n    title = StringField(lookups=[\"icontains\"])\n    status: str\n\n    class Meta:\n        operator = \"AND\"  # Default, can be omitted\n\n# ?title__icontains=django&amp;status=published\n# SQL: WHERE title ILIKE '%django%' AND status = 'published'\n</code></pre> <p>OR - Any filter can match:</p> <pre><code>class ArticleFilterSet(FilterSet):\n    title = StringField(lookups=[\"icontains\"])\n    content = StringField(lookups=[\"icontains\"])\n\n    class Meta:\n        operator = \"OR\"\n\n# ?title__icontains=django&amp;content__icontains=python\n# SQL: WHERE title ILIKE '%django%' OR content ILIKE '%python%'\n</code></pre>"},{"location":"tutorial/filtering/#custom-methods","title":"Custom Methods","text":"<p>Custom methods handle complex filtering logic that can't be expressed with simple lookups.</p>"},{"location":"tutorial/filtering/#your-first-custom-method","title":"Your First Custom Method","text":"<pre><code>from django.db.models import Q\nfrom restflow.filters import FilterSet, StringField, IntegerField, BooleanField\n\nclass ArticleFilterSet(FilterSet):\n    # Custom filter with method\n    search = StringField(method=\"filter_search\")\n\n    # Regular filters\n    status: str\n    views = IntegerField(lookups=[\"comparison\"])\n\n    def filter_search(self, filterset, queryset, value):\n        \"\"\"Search across title and content\"\"\"\n        return Q(\n            title__icontains=value\n        ) | Q(\n            content__icontains=value\n        )\n\n# ?search=django  # Searches in both title and content\n</code></pre>"},{"location":"tutorial/filtering/#why-q-objects","title":"Why Q Objects?","text":"<p>\u2705 Always return Q objects from custom methods:</p> <pre><code>def filter_search(self, filterset, queryset, value):\n    # \u2705 Returns Q object - works with all operators\n    return Q(title__icontains=value) | Q(content__icontains=value)\n</code></pre> <p>\u274c Avoid returning QuerySet ( unless you really need it ):</p> <pre><code>def filter_search(self, filterset, queryset, value):\n    # \u274c Returns QuerySet - operator ignored!\n    return queryset.filter(\n        Q(title__icontains=value) | Q(content__icontains=value)\n    )\n</code></pre> <p>Why Q objects? - Works correctly with all operators (AND, OR, XOR) - Properly combined with other filters - More predictable behavior</p>"},{"location":"tutorial/filtering/#the-queryset-return-caveat","title":"The QuerySet Return Caveat","text":"<p>\u26a0\ufe0f CRITICAL: When returning QuerySet instead of Q objects, the FilterSet operator is NOT applied:</p> <pre><code>class ArticleFilterSet(FilterSet):\n    popular = BooleanField(method=\"filter_popular\")\n    status: str\n\n    class Meta:\n        operator = \"OR\"  # \u26a0\ufe0f Won't apply to QuerySet returns!\n\n    def filter_popular(self, filterset, queryset, value):\n        # \u274c Returns QuerySet - bypasses operator\n        if value:\n            return queryset.filter(views__gte=1000)\n        return queryset\n\n# ?popular=true&amp;status=published\n# Expected (OR): popular OR published\n# Actual: popular AND published (operator ignored!)\n</code></pre> <p>\u2705 Solution:</p> <pre><code>def filter_popular(self, filterset, queryset, value):\n    if value:\n        return Q(views__gte=1000)\n    return Q()  # Empty Q matches everything\n</code></pre>"},{"location":"tutorial/filtering/#conditional-logic","title":"Conditional Logic","text":"<pre><code>class ArticleFilterSet(FilterSet):\n    search = StringField(method=\"filter_search\")\n    quality = StringField(method=\"filter_quality\")\n\n    def filter_search(self, filterset, queryset, value):\n        return Q(title__icontains=value) | Q(content__icontains=value)\n\n    def filter_quality(self, filterset, queryset, value):\n        \"\"\"Filter by quality level\"\"\"\n        if value == \"high\":\n            return Q(status='published', is_featured=True, views__gte=1000)\n        elif value == \"medium\":\n            return Q(status='published', views__gte=100)\n        elif value == \"low\":\n            return Q(views__lt=100)\n        return Q()\n\n# ?quality=high\n</code></pre>"},{"location":"tutorial/filtering/#accessing-request-data","title":"Accessing Request Data","text":"<pre><code>class ArticleFilterSet(FilterSet):\n    my_articles = BooleanField(method=\"filter_my_articles\")\n\n    def filter_my_articles(self, filterset, queryset, value):\n        \"\"\"Filter articles by current user\"\"\"\n        if value and filterset.request and filterset.request.user.is_authenticated:\n            return Q(author=filterset.request.user)\n        return Q()\n\n# ?my_articles=true  (requires authentication)\n</code></pre>"},{"location":"tutorial/filtering/#related-fields","title":"Related Fields","text":""},{"location":"tutorial/filtering/#foreignkey-filtering","title":"ForeignKey Filtering","text":"<pre><code>class ArticleFilterSet(FilterSet):\n    # Filter by category ID\n    category = IntegerField(lookup_expr=\"category__id\")\n\n    # Filter by category slug\n    category_slug = StringField(lookup_expr=\"category__slug\")\n\n    # Filter by author ID\n    author = IntegerField(lookup_expr=\"author__id\")\n\n    # Filter by author username\n    author_username = StringField(lookup_expr=\"author__username__icontains\")\n\n# ?category=1\n# ?category_slug=python\n# ?author_username=john\n</code></pre>"},{"location":"tutorial/filtering/#manytomany-filtering","title":"ManyToMany Filtering","text":"<pre><code>from typing import List\n\nclass ArticleFilterSet(FilterSet):\n    # Filter by tag IDs\n    tags: List[int]\n    # Auto-creates: tags__in\n\n    # Or explicit\n    tag_ids = ListField(\n        child=IntegerField(),\n        lookup_expr=\"tags__id__in\"\n    )\n\n# ?tags=1,2,3\n# ?tag_ids=1,2,3\n</code></pre>"},{"location":"tutorial/filtering/#filtering-by-related-object-existence","title":"Filtering by Related Object Existence","text":"<pre><code>class ArticleFilterSet(FilterSet):\n    has_category = BooleanField(method=\"filter_has_category\")\n\n    def filter_has_category(self, filterset, queryset, value):\n        if value:\n            return Q(category__isnull=False)\n        return Q(category__isnull=True)\n\n# ?has_category=true\n</code></pre>"},{"location":"tutorial/filtering/#counting-related-objects","title":"Counting Related Objects","text":"<p>Add a Comment model first:</p> <pre><code># articles/models.py\nclass Comment(models.Model):\n    article = models.ForeignKey(Article, on_delete=models.CASCADE, related_name='comments')\n    author = models.ForeignKey(User, on_delete=models.CASCADE)\n    content = models.TextField()\n    created_at = models.DateTimeField(auto_now_add=True)\n</code></pre> <p>Then filter by count:</p> <pre><code>from django.db.models import Count\n\ndef add_annotations(filterset, queryset):\n    return queryset.annotate(\n        comment_count=Count('comments')\n    )\n\nclass ArticleFilterSet(FilterSet):\n    min_comments = IntegerField(method=\"filter_min_comments\")\n    has_comments = BooleanField(method=\"filter_has_comments\")\n\n    class Meta:\n        preprocessors = [add_annotations]\n\n    def filter_min_comments(self, filterset, queryset, value):\n        return Q(comment_count__gte=value)\n\n    def filter_has_comments(self, filterset, queryset, value):\n        if value:\n            return Q(comment_count__gt=0)\n        return Q(comment_count=0)\n\n# ?min_comments=5\n# ?has_comments=true\n</code></pre>"},{"location":"tutorial/filtering/#performance-select_related-and-prefetch_related","title":"Performance: select_related and prefetch_related","text":"<pre><code>def optimize_queries(filterset, queryset):\n    \"\"\"Optimize database queries\"\"\"\n    return queryset.select_related(\n        'author',\n        'category'\n    ).prefetch_related(\n        'tags',\n        'comments'\n    )\n\nclass ArticleFilterSet(FilterSet):\n    class Meta:\n        preprocessors = [optimize_queries, add_annotations]\n\n# Without optimization: 1 + N queries\n# With optimization: 2-3 queries total\n</code></pre>"},{"location":"tutorial/filtering/#ensure-distinct-for-m2m","title":"Ensure Distinct for M2M","text":"<pre><code>def smart_distinct(filterset, queryset):\n    \"\"\"Remove duplicates from M2M filtering\"\"\"\n    if 'tags' in filterset.data:\n        return queryset.distinct()\n    return queryset\n\nclass ArticleFilterSet(FilterSet):\n    tags: List[int]\n\n    class Meta:\n        postprocessors = [smart_distinct]\n</code></pre>"},{"location":"tutorial/filtering/#validation-and-ordering","title":"Validation and Ordering","text":""},{"location":"tutorial/filtering/#field-level-validation","title":"Field-Level Validation","text":"<pre><code>from rest_framework.validators import MinValueValidator\n\nclass ArticleFilterSet(FilterSet):\n    title = StringField(\n        min_length=2,\n        max_length=200,\n        lookups=[\"icontains\"]\n    )\n\n    views = IntegerField(\n        min_value=0,\n        max_value=1_000_000,\n        lookups=[\"comparison\"],\n        validators=[MinValueValidator(0)]\n    )\n\n# ?views=-10  \u2192  {\"views\": [\"Ensure this value &gt;= 0.\"]}\n# ?title=a    \u2192  {\"title\": [\"Ensure this has at least 2 characters.\"]}\n</code></pre>"},{"location":"tutorial/filtering/#filterset-level-validation","title":"FilterSet-Level Validation","text":"<pre><code>from rest_framework.exceptions import ValidationError\n\nclass ArticleFilterSet(FilterSet):\n    min_views = IntegerField(lookup_expr=\"views__gte\")\n    max_views = IntegerField(lookup_expr=\"views__lte\")\n\n    def validate(self, data):\n        if 'min_views' in data and 'max_views' in data:\n            if data['min_views'] &gt; data['max_views']:\n                raise ValidationError({\n                    'max_views': 'Must be greater than min_views'\n                })\n        return data\n\n# ?min_views=1000&amp;max_views=500  \u2192  400 Bad Request\n</code></pre>"},{"location":"tutorial/filtering/#ordering","title":"Ordering","text":"<pre><code>class ArticleFilterSet(FilterSet):\n    title = StringField(lookups=[\"icontains\"])\n    status: str\n\n    class Meta:\n        order_fields = [\n            ('title', 'title'),\n            ('views', 'views'),\n            ('created_at', 'created_at'),\n        ]\n\n# Usage:\n# ?order_by=title          # Ascending\n# ?order_by=-title         # Descending\n# ?order_by=-views         # Most viewed first\n# ?order_by=-created_at    # Newest first\n</code></pre>"},{"location":"tutorial/filtering/#ordering-by-annotated-fields","title":"Ordering by Annotated Fields","text":"<pre><code>def add_annotations(filterset, queryset):\n    return queryset.annotate(\n        comment_count=Count('comments')\n    )\n\nclass ArticleFilterSet(FilterSet):\n    class Meta:\n        preprocessors = [add_annotations]\n        order_fields = [\n            ('title', 'title'),\n            ('views', 'views'),\n            ('comment_count', 'comments'),\n        ]\n\n# ?order_by=-comments  # Most commented first\n</code></pre>"},{"location":"tutorial/filtering/#default-ordering","title":"Default Ordering","text":"<pre><code>class ArticleFilterSet(FilterSet):\n    class Meta:\n        order_fields = [('title', 'title'), ('created_at', 'created_at')]\n        default_order_fields = [\"created_at\"]\n\n# Queries without ?order_by get default ordering\n</code></pre>"},{"location":"tutorial/filtering/#pagination","title":"Pagination","text":"<pre><code>from rest_framework.pagination import PageNumberPagination\n\nclass ArticlePagination(PageNumberPagination):\n    page_size = 10\n    page_size_query_param = 'page_size'\n    max_page_size = 100\n\nclass ArticleListView(generics.ListAPIView):\n    serializer_class = ArticleSerializer\n    pagination_class = ArticlePagination\n\n    def get_queryset(self):\n        queryset = Article.objects.all()\n        filterset = ArticleFilterSet(request=self.request)\n        return filterset.filter_queryset(queryset)\n\n# ?page=1&amp;page_size=20\n# ?status=published&amp;order_by=-views&amp;page=2\n</code></pre>"},{"location":"tutorial/filtering/#performance-optimization","title":"Performance Optimization","text":""},{"location":"tutorial/filtering/#query-optimization","title":"Query Optimization","text":"<pre><code>def optimize_queries(filterset, queryset):\n    \"\"\"Optimize all database queries\"\"\"\n    # Select related ForeignKeys\n    queryset = queryset.select_related('author', 'category')\n\n    # Conditionally prefetch M2M\n    if 'tags' in filterset.data:\n        queryset = queryset.prefetch_related('tags')\n\n    if 'min_comments' in filterset.data or 'has_comments' in filterset.data:\n        queryset = queryset.prefetch_related('comments')\n\n    # Only select needed fields\n    queryset = queryset.only(\n        'id', 'title', 'status', 'views',\n        'created_at', 'author_id', 'category_id'\n    )\n\n    return queryset\n\nclass ArticleFilterSet(FilterSet):\n    class Meta:\n        preprocessors = [optimize_queries, add_annotations]\n</code></pre>"},{"location":"tutorial/filtering/#database-indexes","title":"Database Indexes","text":"<pre><code># articles/models.py\nclass Article(models.Model):\n    # ... fields ...\n\n    class Meta:\n        ordering = ['-created_at']\n        indexes = [\n            models.Index(fields=['status']),\n            models.Index(fields=['created_at']),\n            models.Index(fields=['status', '-created_at']),\n            models.Index(fields=['author', '-created_at']),\n            models.Index(fields=['category', 'status']),\n        ]\n</code></pre> <p>Run migrations:</p> <pre><code>python manage.py makemigrations\npython manage.py migrate\n</code></pre>"},{"location":"tutorial/filtering/#monitor-performance","title":"Monitor Performance","text":"<pre><code>import time\nimport logging\n\nlogger = logging.getLogger(__name__)\n\ndef monitor_performance(filterset, queryset):\n    start = time.time()\n    count = queryset.count()\n    duration = time.time() - start\n\n    if duration &gt; 1.0:\n        logger.warning(\n            f\"Slow query: {duration:.2f}s for {count} results. \"\n            f\"Filters: {dict(filterset.data)}\"\n        )\n\n    return queryset\n\nclass ArticleFilterSet(FilterSet):\n    class Meta:\n        postprocessors = [smart_distinct, monitor_performance]\n</code></pre>"},{"location":"tutorial/filtering/#complete-production-ready-filterset","title":"Complete Production-Ready FilterSet","text":"<pre><code>from django.db.models import Count, Q\nfrom rest_framework.validators import MinValueValidator\nfrom rest_framework.exceptions import ValidationError\nfrom restflow.filters import (\n    FilterSet,\n    StringField,\n    IntegerField,\n    BooleanField,\n    DateTimeField,\n    ListField,\n)\nimport logging\n\nlogger = logging.getLogger(__name__)\n\n# Preprocessors\ndef optimize_queries(filterset, queryset):\n    queryset = queryset.select_related('author', 'category')\n\n    if 'tags' in filterset.data:\n        queryset = queryset.prefetch_related('tags')\n\n    if 'min_comments' in filterset.data or 'has_comments' in filterset.data:\n        queryset = queryset.prefetch_related('comments')\n\n    queryset = queryset.only(\n        'id', 'title', 'status', 'views',\n        'created_at', 'author_id', 'category_id'\n    )\n\n    return queryset\n\ndef add_annotations(filterset, queryset):\n    return queryset.annotate(\n        comment_count=Count('comments')\n    )\n\n# Postprocessors\ndef smart_distinct(filterset, queryset):\n    if 'tags' in filterset.data:\n        return queryset.distinct()\n    return queryset\n\n\ndef monitor_performance(filterset, queryset):\n    import time\n    start = time.time()\n    count = queryset.count()\n    duration = time.time() - start\n\n    if duration &gt; 1.0:\n        logger.warning(\n            f\"Slow query: {duration:.2f}s for {count} results. \"\n            f\"Filters: {dict(filterset.data)}\"\n        )\n\n    return queryset\n\n# FilterSet\nclass ArticleFilterSet(FilterSet):\n    # Text search\n    search = StringField(method=\"filter_search\")\n\n    # Basic filters with validation\n    title = StringField(min_length=2, lookups=[\"icontains\"])\n    status: str\n    views = IntegerField(min_value=0, lookups=[\"comparison\"])\n\n    # Related filters\n    author = IntegerField(lookup_expr=\"author__id\")\n    category_slug = StringField(lookup_expr=\"category__slug\")\n    tags: ListField[int]\n\n    # Custom filters\n    my_articles = BooleanField(method=\"filter_my_articles\")\n    has_comments = BooleanField(method=\"filter_has_comments\")\n    min_comments = IntegerField(method=\"filter_min_comments\")\n\n    # Date filters\n    published_at = DateTimeField(lookups=[\"comparison\"])\n    created_at = DateTimeField(lookups=[\"comparison\"])\n\n    class Meta:\n        preprocessors = [\n            optimize_queries,\n            add_annotations,\n        ]\n\n        postprocessors = [\n            smart_distinct,\n            monitor_performance,\n        ]\n\n        order_fields = [\n            ('title', 'title'),\n            ('views', 'views'),\n            ('created_at', 'created_at'),\n            ('comment_count', 'comments'),\n        ]\n\n        operator = \"AND\"\n\n    def validate(self, data):\n        # Add custom validation here\n        return data\n\n    def filter_search(self, filterset, queryset, value):\n        return Q(title__icontains=value) | Q(content__icontains=value)\n\n    def filter_my_articles(self, filterset, queryset, value):\n        if value and filterset.request and filterset.request.user.is_authenticated:\n            return Q(author=filterset.request.user)\n        return Q()\n\n    def filter_has_comments(self, filterset, queryset, value):\n        if value:\n            return Q(comment_count__gt=0)\n        return Q(comment_count=0)\n\n    def filter_min_comments(self, filterset, queryset, value):\n        return Q(comment_count__gte=value)\n</code></pre>"},{"location":"tutorial/filtering/#testing","title":"Testing","text":"<pre><code>from django.test import TestCase\nfrom django.test.utils import override_settings\nfrom django.db import connection\nfrom rest_framework.test import APIClient\n\nclass ArticleFilterPerformanceTest(TestCase):\n    def setUp(self):\n        self.client = APIClient()\n        # Create test data...\n\n    @override_settings(DEBUG=True)\n    def test_query_count(self):\n        \"\"\"Ensure no N+1 queries\"\"\"\n        connection.queries_log.clear()\n\n        response = self.client.get('/api/articles/?status=published')\n\n        # Should be 2-3 queries max (with select_related)\n        query_count = len(connection.queries)\n        self.assertLessEqual(query_count, 3)\n\n    def test_large_dataset_performance(self):\n        \"\"\"Ensure filters are fast\"\"\"\n        import time\n\n        start = time.time()\n        response = self.client.get('/api/articles/?status=published')\n        duration = time.time() - start\n\n        # Should complete in under 100ms\n        self.assertLess(duration, 0.1)\n        self.assertEqual(response.status_code, 200)\n</code></pre>"},{"location":"tutorial/filtering/#summary","title":"Summary","text":"<ol> <li>Basic Filtering: Type annotations and explicit fields</li> <li>Lookups: Text, numeric, date lookups and categories</li> <li>Custom Methods: Q objects, conditional logic, and the QuerySet caveat</li> <li>Related Fields: ForeignKey, ManyToMany, counting, and optimization</li> <li>Validation: Field and FilterSet-level validation</li> <li>Ordering: Basic and annotated field ordering</li> <li>Performance: Query optimization, indexes, and monitoring</li> </ol>"},{"location":"tutorial/filtering/#next-steps","title":"Next Steps","text":"<ul> <li>FilterSet Guide - Complete FilterSet reference with all Meta options, operators, preprocessors, postprocessors, custom methods, and performance patterns</li> <li>Fields Guide - Every field type, lookup, validation, and PostgreSQL feature</li> </ul>"}]}